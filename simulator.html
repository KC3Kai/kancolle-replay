<html>
<head>
	<title>KanColle Sortie Simulator</title>
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta content="utf-8" http-equiv="encoding">

	<link rel="stylesheet" href="css/simulator-ui/main.css"/>
	<link rel="stylesheet" href="css/simulator-ui/fleet-editor.css"/>
	<link rel="stylesheet" href="css/simulator-ui/selector.css"/>

	<script src="js/kcSHIPDATA.js"></script>
	<script src="js/kcEQDATA.js"></script>
	<script src="js/kcMAPDATA.js"></script>
	<script src="js/kcEDGES.js"></script>
	<script src="js/kcENEMYCOMP.js"></script>
	<script src="js/shared.js"></script>
	<script src="js/kcships.js"></script>
	<script src="js/kcsim.js"></script>
	<script src="js/kcsimcombined.js"></script>
	<script src="js/vue.global.prod.js"></script>
	<script src="js/vue-i18n.global.prod.js"></script>
	<script src="reader/lz-string.js"></script>
	<script src="js/simulator-ui/common.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/lzma/src/lzma_worker.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body style="display:none">
	<div id="divMain">
		<div id="divNavBar" :style="{'pointer-events':isDragging?'none':''}">
			<div><span class="title" :title="$t('kancolle_sortie_simulator_sub')">KanColle Sortie Simulator</span></div>
			<div id="divNavButtons">
				<div @mouseover="showDropdownPlayer=true" @mouseout="showDropdownPlayer=false">
					<div class="navButton" @click="onclickNavButton('divPlayerScroll')">{{$t('fleets')}}</div>
					<div v-show="showDropdownPlayer" class="navDropdown">
						<div class="navButton sub" @click="onclickNavButton('divPlayerMainScroll')">{{$t('main_fleet')}}</div>
						<div class="navButton sub" @click="onclickNavButton('divPlayerSupportNScroll')">{{$t('support_fleet_normal')}}</div>
						<div class="navButton sub" @click="onclickNavButton('divPlayerSupportBScroll')">{{$t('support_fleet_boss')}}</div>
						<div class="navButton sub" @click="onclickNavButton('divPlayerLBASScroll')">{{$t('lbas')}}</div>
						<div class="navButton sub" @click="onclickNavButton('divPlayerFFScroll')">{{$t('friend_fleet')}}</div>
					</div>
				</div>
				<div @mouseover="showDropdownBattles=true" @mouseout="showDropdownBattles=false">
					<div class="navButton" @click="onclickNavButton('divBattlesScroll')">{{$t('battles')}}</div>
					<div v-show="showDropdownBattles" class="navDropdown">
						<div class="navButton sub" v-for="n in battles.length" @click="onclickNavButton('divBattlesNodeScroll'+(n-1),0)">{{$t('node_n',[n])}}</div>
					</div>
				</div>
				<div @mouseover="showDropdownSettings=true" @mouseout="showDropdownSettings=false">
					<div class="navButton" @click="onclickNavButton('divSettingsScroll')">{{$t('settings')}}</div>
					<div v-show="showDropdownSettings" class="navDropdown">
						<div class="navButton sub" @click="onclickNavButton('divSettingsHistoricalScroll')">{{$t('historical_bonus')}}</div>
						<div class="navButton sub" @click="onclickNavButton('divSettingsMechanicsScroll')">{{$t('mechanics')}}</div>
						<div class="navButton sub" @click="onclickNavButton('divSettingsAdvancedScroll')">{{$t('show_advanced')}}</div>
					</div>
				</div>
				<div class="navButton" @click="onclickNavButton('divSimulationScroll')">{{$t('simulation')}}</div>
			</div>
			<div id="divNavSimShortcut">
				<input type="button" value="&#9654;" @click="onclickNavSim"/>
				<span>&nbsp;{{$t('simulate_n_times',[numSim])}}</span>
			</div>
		</div>
		<div class="scrollAnchor"><div ref="divPlayerScroll"></div></div>
		<div style="height:10px"></div>
		
		<div id="divPlayer">
			<div class="fleetSection">
				<label><input type="radio" value="en" v-model="$i18n.locale" @change="onchangeLang"/>EN</label> <label><input type="radio" value="ja" v-model="$i18n.locale" @change="onchangeLang"/>JP</label>
				&nbsp;&nbsp;&nbsp;&nbsp;
				<input type="button" :value="$t('save_load_simulator_backup')" @click="onclickBackup"/>&nbsp;
				<input type="button" :value="$t('import_export_deckbuilder_format')" @click="onclickDeckbuilder"/>&nbsp;
			</div>
			<h2>{{$t('fleets')}}</h2>
			<div class="fleetSection">
				<div class="scrollAnchor"><div ref="divPlayerMainScroll"></div></div>
				<vfleet :fleet="fleetFMain" :fleetname="$t('main_fleet')"></vfleet>
			</div>
			<div class="fleetSection">
				<div class="scrollAnchor"><div ref="divPlayerSupportNScroll"></div></div>
				<vfleet :fleet="fleetFSupportN" :fleetname="$t('support_fleet_normal')"></vfleet>
				<label><input type="checkbox" v-model="useSupportN"/> {{$t('use_normal_support')}}</label>
			</div>
			<div class="fleetSection">
				<div class="scrollAnchor"><div ref="divPlayerSupportBScroll"></div></div>
				<vfleet :fleet="fleetFSupportB" :fleetname="$t('support_fleet_boss')"></vfleet>
				<label><input type="checkbox" v-model="useSupportB"/> {{$t('use_boss_support')}}</label>
			</div>
			<div class="fleetSection">
				<div class="scrollAnchor"><div ref="divPlayerLBASScroll"></div></div>
				<div class="fleet lbas">
					<div class="preview" @click="lbExpanded=!lbExpanded">
						<div class="header" ref="header">
							<div>{{$t('land_base_aerial_support')}}</div>
							<div class="expand">
								<span v-show="!lbExpanded">[+]</span>
								<span v-show="lbExpanded">[&#8722;]</span>
							</div>
						</div>
						<div class="iconsWrap">
							<div v-for="base in landBases" class="icon">
								<img :src="'assets/icons/LBAS' + (base.ind+1) + '.png'"/>
							</div>
						</div>
					</div>
					<div v-show="lbExpanded">
						<vlbaseditor :bases="landBases"></vlbaseditor>
					</div>
				</div>
			</div>
			<div class="fleetSection">
				<div class="scrollAnchor"><div ref="divPlayerFFScroll"></div></div>
				<vfleetcomps :comps="fleetsFFriend" :fleetname="$t('friend_fleet')" canimportkcnav="1" isfriendfleet="1"></vfleetcomps>
				<label><input type="checkbox" v-model="useFF"/> {{$t('use_friend_fleet')}}</label>
			</div>
		</div>
		
		<hr>
		<div class="scrollAnchor"><div ref="divBattlesScroll"></div></div>
		<div id="divBattles">
			<h2>{{$t('battles')}}</h2>
			<div class="battleNext">
				<input type="button" :value="$t('insert_node')" @click="onclickInsertBattle(0)" />
			</div>
			<div v-for="(battle,i) in battles" :key="battle.id">
				<div class="scrollAnchor"><div :ref="'divBattlesNodeScroll'+i"></div></div>
				<vbattle :battle="battle" :candelete="canDeleteBattles" :isboss="battle.ind==battles.length-1"></vbattle>
				<div class="battleNext">
					<input type="button" :value="$t('insert_node')" @click="onclickInsertBattle(battle.ind+1)" />
				</div>
			</div>
		</div>
		
		<hr>
		<div class="scrollAnchor"><div ref="divSettingsScroll"></div></div>
		<div id="divSettings">
			<h2>{{$t('settings')}}</h2>
			<div>
				<div><label><input type="checkbox" v-model="settings.retreatOnTaiha" /> <i18n-t keypath="retreat_on_taiha" scope="global"><template v-slot:img_taiha><img src="assets/stats/taiha.png"/></template></i18n-t></label> <img v-show="!settings.retreatOnTaiha" src="assets/stats/kuso.png" /></div>
				<div style="margin-left:20px"><i18n-t keypath="retreat_on_taiha_even" scope="global">
					<template v-slot:img_taiha><img src="assets/stats/taiha.png"/></template>
					<template v-slot:img_repair><img src="assets/items/14.png"/></template>
					<template v-slot:sel_node><select v-model="settingsFCF.dameconNode"><option value="0">{{$t('none_node')}}</option><option v-for="(battle,i) in battles" :value="battle.id">{{i+1}}</option></select></template>
				</i18n-t></div>
				<div><img src="assets/items/28.png"/><input type="button" :value="$t('fcf_settings')" @click="onclickSetFCF"/> <span v-show="hasFCFSettings" class="bonusMarker fcf" :title="$t('fcf_settings_set')">&#11044;</span></div>
				<div><label><input type="checkbox" v-model="settings.replaceImpossibleFormations"/> <i18n-t keypath="replace_formations" scope="global">
					<template v-slot:closest_alternative><span class="tooltip" :title="$t('closest_alternative_tooltip')">{{$t('closest_alternative')}}</span></template>
				</i18n-t></label></div>
			</div>
			<div>
				<div><img src="assets/stats/bucket.png" />: <i18n-t keypath="bucket_count_use" scope="global">
					<template v-slot:inp_hp><input type="number" min="0" max="100" v-model="settings.bucketPercent" :class="getClassSetting('bucketPercent')"/></template>
					<template v-slot:inp_time><input type="number" min="0" max="100" v-model="settings.bucketTime" :class="getClassSetting('bucketTime')"/></template>
				</i18n-t></div>
				<div style="margin-left:26px"><i18n-t keypath="bucket_do_not_count_use" scope="global">
					<template v-slot:inp_time><input type="number" min="0" max="100" v-model="settings.bucketTimeIgnore" :class="getClassSetting('bucketTimeIgnore')"/></template>
				</i18n-t></div>
				<div><label><input type="checkbox" v-model="settings.carryOverHP" /><i18n-t keypath="carry_over_ship_hp" scope="global"><template v-slot:img_bucket><img src="assets/stats/bucket.png" /></template></i18n-t></label></div>
				<div><label><input type="checkbox" v-model="settings.carryOverMorale" />{{$t('carry_over_ship_morale')}}</label></div>
			</div>
			<div>
				<label><input type="checkbox" v-model="settings.airRaidCostW6" /> {{$t('use_default_w6_air_raid')}} (4% <img src="assets/stats/fuel.png" /> 8% <img src="assets/stats/ammo.png" />)</label>
			</div>
			<div>
				<div class="scrollAnchor"><div ref="divSettingsHistoricalScroll"></div></div>
				<div><span class="subheader">{{$t('historical_bonus')}}:</span></div>
				<div>
					<input type="button" :value="$t('auto_set_bonus')" @click="onclickAutoBonus"/>
					<span class="autoBonusStatus" :class="classAutoBonusStatus">&nbsp;{{autoBonusStatus}}</span> <span v-if="autoBonus">({{autoBonusName}}, {{$t('autobonus_nodes')}}: {{autoBonusNodes}})</span>
				</div>
				<div style="margin-top:20px">
					<input type="button" :value="$t('import_mapwide_bonuses_once')" @click="onclickBonusImporter"/>
				</div>
			</div>
			<div id="divSettingsMechanics">
				<div class="scrollAnchor"><div ref="divSettingsMechanicsScroll"></div></div>
				<div class="collapseButton" @click="showMechanics=!showMechanics">
					<div><span class="subheader">{{$t('mechanics')}}:</span></div>
					<div>
						<span v-show="!showMechanics">[+]</span>
						<span v-show="showMechanics">[&#8722;]</span>
					</div>
				</div>
				<div class="subsection" v-show="showMechanics">
					<div v-for="mechanic in settings.mechanics">
						<label><input type="checkbox" v-model="mechanic.enabled" @change="onchangeMechanic(mechanic)"/> {{$t('mechanic.' + mechanic.key)}}</label>
					</div>
					<br>
					<table>
					<tr><td><label for="mechShellDmgCap">{{$t('day_shelling_softcap')}}:</label></td><td><input id="mechShellDmgCap" type="number" v-model="settings.shellDmgCap" :class="getClassSetting('shellDmgCap')" min="0" max="9999" /></td></tr>
					<tr><td><label for="mechASWDmgCap">{{$t('asw_softcap')}}:</label></td><td><input id="mechASWDmgCap" type="number" v-model="settings.aswDmgCap" :class="getClassSetting('aswDmgCap')" min="0" max="9999" /></td></tr>
					<tr><td><label for="mechTorpedoDmgCap">{{$t('torpedo_softcap')}}:</label></td><td><input id="mechTorpedoDmgCap" type="number" v-model="settings.torpedoDmgCap" :class="getClassSetting('torpedoDmgCap')" min="0" max="9999" /></td></tr>
					<tr><td><label for="mechNightDmgCap">{{$t('night_softcap')}}:</label></td><td><input id="mechNightDmgCap" type="number" v-model="settings.nightDmgCap" :class="getClassSetting('nightDmgCap')" min="0" max="9999" /></td></tr>
					<tr><td><label for="mechAirDmgCap">{{$t('air_softcap')}}:</label></td><td><input id="mechAirDmgCap" type="number" v-model="settings.airDmgCap" :class="getClassSetting('airDmgCap')" min="0" max="9999" /></td></tr>
					<tr><td><label for="mechSupportDmgCap">{{$t('support_softcap')}}:</label></td><td><input id="mechSupportDmgCap" type="number" v-model="settings.supportDmgCap" :class="getClassSetting('supportDmgCap')" min="0" max="9999" /></td></tr>
					</table>
				</div>
			</div>
			<div id="divSettingsAdvanced">
				<div class="scrollAnchor"><div ref="divSettingsAdvancedScroll"></div></div>
				<div class="collapseButton" @click="settings.showAdvanced=!settings.showAdvanced">
					<div><span class="subheader">{{$t('show_advanced')}}:</span></div>
					<div>
						<span v-show="!settings.showAdvanced">[+]</span>
						<span v-show="settings.showAdvanced">[&#8722;]</span>
					</div>
				</div>
				<div class="subsection" v-show="settings.showAdvanced">
					<div>
						<span class="subheader">{{$t('vanguard_evasion_bonus')}}:</span>
						<div style="display:flex">
							<div>
								<label><input type="radio" value="1" v-model="settings.vanguardUseType"/> {{$t('use_flat_evasion_bonus')}}</label>
								<table>
								<tr><td></td><td>{{$t('shelling')}}</td><td>{{$t('torpedo')}}</td></tr>
								<tr><td>{{$t('DD_n',['1'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellDD[0]" :class="getClassSetting('vanguardEvShellDD',0)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpDD[0]" :class="getClassSetting('vanguardEvTorpDD',0)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('DD_n',['2'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellDD[1]" :class="getClassSetting('vanguardEvShellDD',1)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpDD[1]" :class="getClassSetting('vanguardEvTorpDD',1)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('DD_n',['3'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellDD[2]" :class="getClassSetting('vanguardEvShellDD',2)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpDD[2]" :class="getClassSetting('vanguardEvTorpDD',2)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('DD_n',['4'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellDD[3]" :class="getClassSetting('vanguardEvShellDD',3)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpDD[3]" :class="getClassSetting('vanguardEvTorpDD',3)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('DD_n',['5'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellDD[4]" :class="getClassSetting('vanguardEvShellDD',4)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpDD[4]" :class="getClassSetting('vanguardEvTorpDD',4)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('DD_n',['6'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellDD[5]" :class="getClassSetting('vanguardEvShellDD',5)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpDD[5]" :class="getClassSetting('vanguardEvTorpDD',5)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('DD_n',['7'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellDD[6]" :class="getClassSetting('vanguardEvShellDD',6)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpDD[6]" :class="getClassSetting('vanguardEvTorpDD',6)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('other_n',['1'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellOther[0]" :class="getClassSetting('vanguardEvShellOther',0)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpOther[0]" :class="getClassSetting('vanguardEvTorpOther',0)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('other_n',['2'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellOther[1]" :class="getClassSetting('vanguardEvShellOther',1)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpOther[1]" :class="getClassSetting('vanguardEvTorpOther',1)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('other_n',['3'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellOther[2]" :class="getClassSetting('vanguardEvShellOther',2)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpOther[2]" :class="getClassSetting('vanguardEvTorpOther',2)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('other_n',['4'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellOther[3]" :class="getClassSetting('vanguardEvShellOther',3)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpOther[3]" :class="getClassSetting('vanguardEvTorpOther',3)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('other_n',['5'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellOther[4]" :class="getClassSetting('vanguardEvShellOther',4)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpOther[4]" :class="getClassSetting('vanguardEvTorpOther',4)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('other_n',['6'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellOther[5]" :class="getClassSetting('vanguardEvShellOther',5)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpOther[5]" :class="getClassSetting('vanguardEvTorpOther',5)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								<tr><td>{{$t('other_n',['7'])}}:</td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvShellOther[6]" :class="getClassSetting('vanguardEvShellOther',6)" :disabled="settings.vanguardUseType!=1"/></td><td><input type="number" min="0" max="999" v-model="settings.vanguardEvTorpOther[6]" :class="getClassSetting('vanguardEvTorpOther',6)" :disabled="settings.vanguardUseType!=1"/></td></tr>
								</table>
							</div>
							<div style="margin-left:20px">
								<label><input type="radio" value="2" v-model="settings.vanguardUseType"/> {{$t('use_accuracy_multiplier')}}</label>
								<table>
								<tr><td></td><td>{{$t('shelling')}}</td><td>{{$t('torpedo')}}</td></tr>
								<tr><td>{{$t('DD_n',['1'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellDDMod[0]" :class="getClassSetting('vanguardEvShellDDMod',0)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpDDMod[0]" :class="getClassSetting('vanguardEvTorpDDMod',0)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('DD_n',['2'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellDDMod[1]" :class="getClassSetting('vanguardEvShellDDMod',1)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpDDMod[1]" :class="getClassSetting('vanguardEvTorpDDMod',1)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('DD_n',['3'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellDDMod[2]" :class="getClassSetting('vanguardEvShellDDMod',2)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpDDMod[2]" :class="getClassSetting('vanguardEvTorpDDMod',2)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('DD_n',['4'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellDDMod[3]" :class="getClassSetting('vanguardEvShellDDMod',3)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpDDMod[3]" :class="getClassSetting('vanguardEvTorpDDMod',3)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('DD_n',['5'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellDDMod[4]" :class="getClassSetting('vanguardEvShellDDMod',4)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpDDMod[4]" :class="getClassSetting('vanguardEvTorpDDMod',4)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('DD_n',['6'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellDDMod[5]" :class="getClassSetting('vanguardEvShellDDMod',5)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpDDMod[5]" :class="getClassSetting('vanguardEvTorpDDMod',5)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('DD_n',['7'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellDDMod[6]" :class="getClassSetting('vanguardEvShellDDMod',6)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpDDMod[6]" :class="getClassSetting('vanguardEvTorpDDMod',6)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('other_n',['1'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellOtherMod[0]" :class="getClassSetting('vanguardEvShellOtherMod',0)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpOtherMod[0]" :class="getClassSetting('vanguardEvTorpOtherMod',0)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('other_n',['2'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellOtherMod[1]" :class="getClassSetting('vanguardEvShellOtherMod',1)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpOtherMod[1]" :class="getClassSetting('vanguardEvTorpOtherMod',1)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('other_n',['3'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellOtherMod[2]" :class="getClassSetting('vanguardEvShellOtherMod',2)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpOtherMod[2]" :class="getClassSetting('vanguardEvTorpOtherMod',2)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('other_n',['4'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellOtherMod[3]" :class="getClassSetting('vanguardEvShellOtherMod',3)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpOtherMod[3]" :class="getClassSetting('vanguardEvTorpOtherMod',3)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('other_n',['5'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellOtherMod[4]" :class="getClassSetting('vanguardEvShellOtherMod',4)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpOtherMod[4]" :class="getClassSetting('vanguardEvTorpOtherMod',4)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('other_n',['6'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellOtherMod[5]" :class="getClassSetting('vanguardEvShellOtherMod',5)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpOtherMod[5]" :class="getClassSetting('vanguardEvTorpOtherMod',5)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								<tr><td>{{$t('other_n',['7'])}}:</td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvShellOtherMod[6]" :class="getClassSetting('vanguardEvShellOtherMod',6)" :disabled="settings.vanguardUseType!=2"/></td><td><input type="number" min="0" max="1" step=".01" v-model="settings.vanguardEvTorpOtherMod[6]" :class="getClassSetting('vanguardEvTorpOtherMod',6)" :disabled="settings.vanguardUseType!=2"/></td></tr>
								</table>
								<input type="button" :value="$t('set_event_values')" @click="onclickVanguardSet('event')"/> <input type="button" :value="$t('set_normal_values')" @click="onclickVanguardSet('normal')"/>
							</div>
						</div>
						<div>
						
						</div>
					</div>
					<div>
						<span class="subheader">{{$t('special_attack_activation_rate')}}:</span>
						<table>
						<tr>
							<td>{{$t('nelson_touch')}}:</td><td><input type="number" min="0" max="100" v-model="settings.nelsonTouchRate" :class="getClassSetting('nelsonTouchRate')" :disabled="settings.nelsonTouchUseFormula"/>%</td>
							<td><label><input type="checkbox" v-model="settings.nelsonTouchUseFormula"/> <i18n-t keypath="use_provisional_link" scope="global">
								<template v-slot:link><a href="https://twitter.com/Divinity_123/status/1820114418904002935">{{$t('formula')}}</a></template>
							</i18n-t>: {{getNelsonTouchFormula()}}%</label></td>
						</tr>
						<tr>
							<td>{{$t('nagato_special')}}:</td><td><input type="number" min="0" max="100" v-model="settings.nagatoSpecialRate" :class="getClassSetting('nagatoSpecialRate')" :disabled="settings.nagatoSpecialUseFormula"/>%</td>
							<td><label><input type="checkbox" v-model="settings.nagatoSpecialUseFormula"/> <i18n-t keypath="use_provisional_link" scope="global">
								<template v-slot:link><a href="https://twitter.com/Divinity_123/status/1820114420569162214">{{$t('formula')}}</a></template>
							</i18n-t>: {{getNagatoSpecialFormula()}}%</label></td>
						</tr>
						<tr>
							<td>{{$t('mutsu_special')}}:</td><td><input type="number" min="0" max="100" v-model="settings.mutsuSpecialRate" :class="getClassSetting('mutsuSpecialRate')" :disabled="settings.mutsuSpecialUseFormula"/>%</td>
							<td><label><input type="checkbox" v-model="settings.mutsuSpecialUseFormula"/> <i18n-t keypath="use_provisional_link" scope="global">
								<template v-slot:link><a href="https://twitter.com/Divinity_123/status/1820114420569162214">{{$t('formula')}}</a></template>
							</i18n-t>: {{getNagatoSpecialFormula()}}%</label></td>
						</tr>
						<tr>
							<td>{{$t('colorado_special')}}:</td><td><input type="number" min="0" max="100" v-model="settings.coloradoSpecialRate" :class="getClassSetting('coloradoSpecialRate')"/>%</td>
						</tr>
						<tr>
							<td>{{$t('kongou_special')}}:</td><td><input type="number" min="0" max="100" v-model="settings.kongouSpecialRate" :class="getClassSetting('kongouSpecialRate')" :disabled="settings.kongouSpecialUseFormula"/>%</td>
							<td><label><input type="checkbox" v-model="settings.kongouSpecialUseFormula"/> <i18n-t keypath="use_provisional_link" scope="global">
								<template v-slot:link><a href="https://twitter.com/Divinity_123/status/1820114427619709288">{{$t('formula')}}</a></template>
							</i18n-t>: {{getKongouSpecialFormula()}}%</label></td>
						</tr>
						<tr>
							<td>{{$t('yamato_special_3')}}:</td><td><input type="number" min="0" max="100" v-model="settings.yamatoSpecial3Rate" :class="getClassSetting('yamatoSpecial3Rate')"/>%</td>
						</tr>
						<tr>
							<td>{{$t('yamato_special_2')}}:</td><td><input type="number" min="0" max="100" v-model="settings.yamatoSpecial2Rate" :class="getClassSetting('yamatoSpecial2Rate')" :disabled="settings.yamatoSpecial2UseFormula"/>%</td>
							<td><label><input type="checkbox" v-model="settings.yamatoSpecial2UseFormula"/> <i18n-t keypath="use_provisional_link" scope="global">
								<template v-slot:link><a href="https://twitter.com/Divinity_123/status/1820114422343376976">{{$t('formula')}}</a></template>
							</i18n-t>: {{getYamatoSpecial2Formula()}}%</label></td>
						</tr>
						<tr>
							<td>{{$t('submarine_special')}}:</td><td><input type="number" min="0" max="100" v-model="settings.subFleetAttackRate" :class="getClassSetting('subFleetAttackRate')"/>%</td>
						</tr>
						<tr>
							<td>{{$t('richelieu_special')}}:</td><td><input type="number" min="0" max="100" v-model="settings.richelieuSpecialRate" :class="getClassSetting('richelieuSpecialRate')"/>%</td>
						</tr>
						</table>
					</div>
					<div>
						<label><input type="checkbox" v-model="settings.enableSkipTorpBonus" :class="getClassSetting('enableSkipTorpBonus')"/><span class="subheader">{{$t('use_provisional_B-25')}}</span></label>
					</div>
					<div>
						<span class="subheader">{{$t('cf_airstrike_base_mods')}}:</span>
						<table>
						<tr><td></td><td colspan="2">{{$t('damage_base',['25'])}}:</td><td> </td><td colspan="2">{{$t('accuracy_base',['95'])}}:</td></tr>
						<tr><td></td><td>{{$t('main')}}</td><td>{{$t('escort')}}</td><td> </td><td>{{$t('main')}}</td><td>{{$t('escort')}}</td></tr>
						<tr>
							<td>{{$t('player_target_battle')}}</td>
							<td><input type="number" min="-999" max="999" v-model="settings.airstrikeDmgMF" :class="getClassSetting('airstrikeDmgMF')"/></td>
							<td><input type="number" min="-999" max="999" v-model="settings.airstrikeDmgEF" :class="getClassSetting('airstrikeDmgEF')"/></td><td> </td>
							<td><input type="number" min="-999" max="999" v-model="settings.airstrikeAccMF" :class="getClassSetting('airstrikeAccMF')"/></td>
							<td><input type="number" min="-999" max="999" v-model="settings.airstrikeAccEF" :class="getClassSetting('airstrikeAccEF')"/></td>
						</tr>
						<tr>
							<td>{{$t('player_target_raid')}}</td>
							<td><input type="number" min="-999" max="999" v-model="settings.airstrikeDmgMFRaid" :class="getClassSetting('airstrikeDmgMFRaid')"/></td>
							<td><input type="number" min="-999" max="999" v-model="settings.airstrikeDmgEFRaid" :class="getClassSetting('airstrikeDmgEFRaid')"/></td><td> </td>
							<td><input type="number" min="-999" max="999" v-model="settings.airstrikeAccMFRaid" :class="getClassSetting('airstrikeAccMFRaid')"/></td>
							<td><input type="number" min="-999" max="999" v-model="settings.airstrikeAccEFRaid" :class="getClassSetting('airstrikeAccEFRaid')"/></td>
						</tr>
						<tr>
							<td>{{$t('enemy_target')}}</td>
							<td><input type="number" min="-999" max="999" v-model="settings.airstrikeDmgME" :class="getClassSetting('airstrikeDmgME')"/></td>
							<td><input type="number" min="-999" max="999" v-model="settings.airstrikeDmgEE" :class="getClassSetting('airstrikeDmgEE')"/></td><td> </td>
							<td><input type="number" min="-999" max="999" v-model="settings.airstrikeAccME" :class="getClassSetting('airstrikeAccME')"/></td>
							<td><input type="number" min="-999" max="999" v-model="settings.airstrikeAccEE" :class="getClassSetting('airstrikeAccEE')"/></td>
						</tr>
						</table>
					</div>
					<div>
						<span class="subheader"><img src="assets/items/23.png"/> {{$t('arctic_camo_bonuses')}}:</span>
						<table>
						<tr><td>{{$t('armour')}}:</td><td><input type="number" min="0" max="999" v-model="settings.arcticCamoAr" :class="getClassSetting('arcticCamoAr')"/></td></tr>
						<tr><td>{{$t('evasion_shelling')}}:</td><td><input type="number" min="0" max="999" v-model="settings.arcticCamoEva" :class="getClassSetting('arcticCamoEva')"/></td></tr>
						</table>
					</div>
					<div>
						<span class="subheader"><img src="assets/items/54.png"/> {{$t('smokescreen_mods')}}:</span>
						<div style="display:flex">
							<table>
								<tr><td colspan="2">{{$t('smoke_level')}}:</td><th>1</th><th>2</th><th>3</th></tr>
								<tr><td colspan="2">{{$t('activation_rate')}}:</td><td v-for="i in 3"><input type="number" min="0" max="100" v-model="settings.smokeChance[i-1]" :class="getClassSetting('smokeChance',i-1)" :disabled="settings.smokeChanceUseFormula"/>%</td></tr>
								<tr><td colspan="5"><label><input type="checkbox" v-model="settings.smokeChanceUseFormula" :class="getClassSetting('smokeChanceUseFormula')"/> <i18n-t keypath="use_provisional_link" scope="global"><template v-slot:link><a href="https://twitter.com/Xe_UCH/status/1767407602554855730" target="_blank">{{$t('activation_formula')}}</a></template></i18n-t></label></td></tr>
								<tr><td colspan="5"></td></tr>
								<tr><td colspan="5">{{$t('shelling_accuracy_multiplier')}}:</td></tr>
								<tr><td style="width:20px"></td><td>{{$t('player_no_radar')}}</td><td v-for="i in 3"><input type="number" min="0" max="1" step=".01" v-model="settings.smokeModShellAccF[i-1]" :class="getClassSetting('smokeModShellAccF',i-1)"/></td></tr>
								<tr><td></td><td>{{$t('player_radar')}}</td><td v-for="i in 3"><input type="number" min="0" max="1" step=".01" v-model="settings.smokeModShellAccFRadar[i-1]" :class="getClassSetting('smokeModShellAccFRadar',i-1)"/></td></tr>
								<tr><td></td><td>{{$t('enemy_no_radar')}}</td><td v-for="i in 3"><input type="number" min="0" max="1" step=".01" v-model="settings.smokeModShellAccE[i-1]" :class="getClassSetting('smokeModShellAccE',i-1)"/></td></tr>
								<tr><td></td><td>{{$t('enemy_radar')}}</td><td v-for="i in 3"><input type="number" min="0" max="1" step=".01" v-model="settings.smokeModShellAccERadar[i-1]" :class="getClassSetting('smokeModShellAccERadar',i-1)"/></td></tr>
								<tr><td colspan="5">{{$t('asw_accuracy_multiplier')}}:</td></tr>
								<tr><td></td><td>{{$t('player')}}</td><td v-for="i in 3"><input type="number" min="0" max="1" step=".01" v-model="settings.smokeModASWAccF[i-1]" :class="getClassSetting('smokeModASWAccF',i-1)"/></td></tr>
								<tr><td></td><td>{{$t('enemy')}}</td><td v-for="i in 3"><input type="number" min="0" max="1" step=".01" v-model="settings.smokeModASWAccE[i-1]" :class="getClassSetting('smokeModASWAccE',i-1)"/></td></tr>
								<tr><td colspan="5">{{$t('torpedo_accuracy_multiplier')}}:</td></tr>
								<tr><td></td><td>{{$t('player')}}</td><td v-for="i in 3"><input type="number" min="0" max="1" step=".01" v-model="settings.smokeModTorpAccF[i-1]" :class="getClassSetting('smokeModTorpAccF',i-1)"/></td></tr>
								<tr><td></td><td>{{$t('enemy')}}</td><td v-for="i in 3"><input type="number" min="0" max="1" step=".01" v-model="settings.smokeModTorpAccE[i-1]" :class="getClassSetting('smokeModTorpAccE',i-1)"/></td></tr>
								<tr><td colspan="5">{{$t('airstrike_accuracy_multiplier')}}:</td></tr>
								<tr><td></td><td>{{$t('player')}}</td><td v-for="i in 3"><input type="number" min="0" max="1" step=".01" v-model="settings.smokeModAirAccF[i-1]" :class="getClassSetting('smokeModAirAccF',i-1)"/></td></tr>
								<tr><td></td><td>{{$t('enemy')}}</td><td v-for="i in 3"><input type="number" min="0" max="1" step=".01" v-model="settings.smokeModAirAccE[i-1]" :class="getClassSetting('smokeModAirAccE',i-1)"/></td></tr>
							</table>
						</div>
						<div><input type="button" :value="$t('set_simulator_suggested_values')" @click="onclickSmokeSet"/> {{$t('airstrike_may_be_inaccurate')}}</div>
						<div><a href="https://docs.google.com/spreadsheets/d/1I_HMplw81mR7g9_jUKRmI7ylhlhKkuvGKtrpj3DJ9zo/edit#gid=0" target="_blank">{{$t('activation_rate_suggestions')}}</a></div>
						<div><a href="https://docs.google.com/spreadsheets/d/1sznusxVurE6iCr2s-gLNpBQ_g1BD5mEMDlltluMB1CE/edit#gid=1397813463" target="_blank">{{$t('other_suggestions_and_data')}}</a></div>
					</div>
					<div>
						<div><span class="subheader">{{$t('shelling_range_tie_randomness_weights')}}:</span></div>
						<div><label><input type="checkbox" v-model="settings.enableRangeWeights" :class="getClassSetting('enableRangeWeights')"/>{{$t('enable_heuristic_weights')}}</label></div>
						<div style="color:red">{{$t('warning_experimental_subject_to_change')}}</div>
						<div :style="{'font-style':($i18n.locale=='en' ? 'italic' : '')}"><i18n-t keypath="shelling_range_tie_description" scope="global"><template v-slot:br><br></template></i18n-t></div>
						<div>
							{{$t('explanation')}}:&nbsp;
							<a href="https://en.kancollewiki.net/Shooting_Order_and_Targeting#Range_Tie_Randomness">[1]</a>&nbsp;
							<a href="https://docs.google.com/spreadsheets/d/1grAtIhlm2YMN9iyvniJA-j1YNCC-SCnA8q6WUi-Ctpg/edit#gid=0">[2]</a>&nbsp;
						</div>
					</div>
					<div>
						<div><span class="subheader">{{$t('override_support_chance')}}:</span></div>
						<div :style="{'font-style':($i18n.locale=='en' ? 'italic' : '')}">{{$t('override_support_chance_desc')}}</div>
						<table>
						<tr><td>{{$t('normal_day')}}:</td><td><input type="number" min="0" max="100" v-model="settings.overrideSupportChanceDayN" :class="getClassSetting('overrideSupportChanceDayN')"/>%</td></tr>
						<tr><td>{{$t('normal_night')}}:</td><td><input type="number" min="0" max="100" v-model="settings.overrideSupportChanceNightN" :class="getClassSetting('overrideSupportChanceNightN')"/>%</td></tr>
						<tr><td>{{$t('boss')}}:</td><td><input type="number" min="0" max="100" v-model="settings.overrideSupportChanceDayB" :class="getClassSetting('overrideSupportChanceDayB')"/>%</td></tr>
						</table>
					</div>
					<div>
						<div><span class="subheader"><img src="assets/items/55.png"/> {{$t('balloon_acc_effects')}}:</span></div>
						<div>{{$t('balloon_own_fleet')}}:</div>
						<div style="margin-left:20px;display:flex;gap:20px">
							<div>{{$t('balloon_airstrike')}}:
							<table>
							<tr v-for="i in 3">
								<th>{{i}}:</th>
								<td>
									({{$t('balloon_acc')}} &#215; <input type="number" min="1" max="2" step=".01" v-model="settings.balloonSelfAirMod[i-1]" :class="getClassSetting('balloonSelfAirMod',i-1)"/>)
									+ <input type="number" min="0" max="99" step="1"v-model="settings.balloonSelfAirFlat[i-1]" :class="getClassSetting('balloonSelfAirFlat',i-1)"/>
								</td>
							</tr>
							</table></div>
							<div>{{$t('balloon_lbas')}}:
							<table>
							<tr v-for="i in 3">
								<th>{{i}}:</th>
								<td>
									({{$t('balloon_acc')}} &#215; <input type="number" min="1" max="2" step=".01" v-model="settings.balloonSelfLBASMod[i-1]" :class="getClassSetting('balloonSelfLBASMod',i-1)"/>)
									+ <input type="number" min="0" max="99" step="1"v-model="settings.balloonSelfLBASFlat[i-1]" :class="getClassSetting('balloonSelfLBASFlat',i-1)"/>
								</td>
							</tr>
							</table></div>
						</div>
						<div>{{$t('balloon_opposing_fleet')}}:</div>
						<div style="margin-left:20px;display:flex;gap:20px">
							<div>{{$t('balloon_airstrike')}}:
							<table>
							<tr v-for="i in 3">
								<th>{{i}}:</th>
								<td>
									({{$t('balloon_acc')}} &#215; <input type="number" min="0" max="1" step=".01" v-model="settings.balloonOppoAirMod[i-1]" :class="getClassSetting('balloonOppoAirMod',i-1)"/>)
									+ <input type="number" min="-99" max="0" step="1" v-model="settings.balloonOppoAirFlat[i-1]" :class="getClassSetting('balloonOppoAirFlat',i-1)"/>
								</td>
							</tr>
							</table></div>
							<div>{{$t('balloon_lbas')}}:
							<table>
							<tr v-for="i in 3">
								<th>{{i}}:</th>
								<td>
									({{$t('balloon_acc')}} &#215; <input type="number" min="0" max="1" step=".01" v-model="settings.balloonOppoLBASMod[i-1]" :class="getClassSetting('balloonOppoLBASMod',i-1)"/>)
									+ <input type="number" min="-99" max="0" step="1" v-model="settings.balloonOppoLBASFlat[i-1]" :class="getClassSetting('balloonOppoLBASFlat',i-1)"/>
								</td>
							</tr>
							</table></div>
						</div>
					</div>
				</div>
			</div>
			<div>
				<input type="button" :value="$t('restore_defaults')" @click="onclickRestoreSettings"/>
			</div>
		</div>
		<hr>
		
		<div class="scrollAnchor"><div ref="divSimulationScroll"></div></div>
		<h2>{{$t('simulation')}}</h2>
		<div id="divSimWatch">
			<input type="button" :value="$t('watch_sortie')" :disabled="!canSim" @click="onclickWatch"/> {{$t('opens_in_replayer')}}
		</div>
		<div id="divSimStats">
			<i18n-t keypath="simulate_n_times_and_show_stats" scope="global"><template v-slot:inp_num><input type="number" min="1" :max="numSimMax" v-model="numSim" /></template></i18n-t>:
			<div id="divSimStatsButtons">
				<input type="button" :value="'&#9654; ' + $t('go')" :disabled="!canSim" @click="onclickGo"/>
				<input type="button" :value="$t('clear')" v-show="results.active&&canSim" @click="onclickClear"/>
			</div>
		</div>
		<div id="divResultsOuter">
			<div style="display:flex;gap:10px" v-show="!canSim">
				<div class="progressBarOuter"><div class="progressBarInner" :style="{width:simProgressPercent+'%'}"></div></div>
				<div><input type="button" :value="'&#9724; ' + $t('stop')" v-show="!canSim" :disabled="canSim" @click="onclickCancel"/></div>
				<div>({{simProgressNum}}/{{simProgressTotal}})</div>
			</div>
			<div id="divResultsErrors">
				<div v-for="error in results.errors">{{$t('sim_error.' + error.key, error.args)}}</div>
			</div>
			<div id="divResultsWarnings">
				<div v-for="warning in results.warnings">{{$t('sim_warning.' + warning.key, warning.args)}}</div>
			</div>
			
			<div id="divResults" ref="divResults" v-show="results.active">
				<h3>
					{{$t('statistics')}}
					<svg @click="onclickScreenShot" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width: 22px;cursor: pointer;fill: #9b9b9b;margin-left: 4px;"><path d="M20,4H16.83L15,2H9L7.17,4H4A2,2 0 0,0 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6A2,2 0 0,0 20,4M20,18H4V6H8.05L9.88,4H14.12L15.95,6H20V18M12,7A5,5 0 0,0 7,12A5,5 0 0,0 12,17A5,5 0 0,0 17,12A5,5 0 0,0 12,7M12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15Z" /></svg>
				</h3>
				<div class="note">{{$t('note_calc_wip')}}</div>
				<div class="noteBold" v-show="results.showCFWarning">{{$t('warn_combined_fleet')}}</div>
				<div>{{$t('number_of_runs')}}: {{results.totalNum}}</div>
				<div id="divResultColsWrap">
					<div class="resultCol">
						<div>
							<div>{{$t('final_rank_rate')}}:</div>
							<table>
							<tr><th><img src="assets/stats/S.png" alt="S"/></th><td><span class="resultBold">{{results.rankS}}</span></td></tr>
							<tr><th><img src="assets/stats/A.png" alt="A"/></th><td>{{results.rankA}}</td></tr>
							<tr><th><img src="assets/stats/B.png" alt="B"/></th><td>{{results.rankB}}</td></tr>
							<tr><th><img src="assets/stats/C.png" alt="C"/></th><td>{{results.rankC}}</td></tr>
							<tr><th><img src="assets/stats/D.png" alt="D"/></th><td>{{results.rankD}}</td></tr>
							<tr><th><img src="assets/stats/E.png" alt="E"/></th><td>{{results.rankE}}</td></tr>
							<tr><th><img src="assets/stats/retreat.png" :alt="$t('retreat')"/></th><td>{{results.retreat}}</td></tr>
							</table>
						</div>
						<div>
							<div>{{$t('enemy_flagship_sunk_rate')}}:</div>
							<table>
							<tr><th><img src="assets/stats/flagsunk.png" :alt="$t('flagship_sunk')"/></th><td><span class="resultBold">{{results.flagSunk}}</span></td></tr>
							</table>
							<div><i18n-t keypath="avg_n_hp_per_run" scope="global"><template v-slot:txt_hp><span class="resultBold">-{{results.flagSunkHP}}</span></template></i18n-t></div>
							<div><i18n-t keypath="avg_n_hp_per_boss" scope="global"><template v-slot:txt_hp><span class="resultBold">-{{results.flagSunkHPBoss}}</span></template></i18n-t></div>
							<div><i18n-t keypath="avg_n_tp_per_run" scope="global"><template v-slot:txt_tp><span class="resultBold">{{results.transport}}</span></template></i18n-t></div>
						</div>
						<div v-show="results.numNodes>1">
							<div>{{$t('rank_per_battle')}}:</div>
							<table class="multi">
							<tr><th>&nbsp;</th><th v-for="n in results.numNodes">{{n}}</th></tr>
							<tr><th><img src="assets/stats/S.png" alt="S"/></th><td v-for="stat in results.rankSNode">{{stat}}</td></tr>
							<tr><th><img src="assets/stats/A.png" alt="A"/></th><td v-for="stat in results.rankANode">{{stat}}</td></tr>
							<tr><th><img src="assets/stats/B.png" alt="B"/></th><td v-for="stat in results.rankBNode">{{stat}}</td></tr>
							<tr><th><img src="assets/stats/C.png" alt="C"/></th><td v-for="stat in results.rankCNode">{{stat}}</td></tr>
							<tr><th><img src="assets/stats/D.png" alt="D"/></th><td v-for="stat in results.rankDNode">{{stat}}</td></tr>
							<tr><th><img src="assets/stats/E.png" alt="E"/></th><td v-for="stat in results.rankENode">{{stat}}</td></tr>
							<tr><th><img src="assets/stats/flagsunk.png" :alt="$t('flagship_sunk')"/></th><td v-for="stat in results.flagSunkNode">{{stat}}</td></tr>
							</table>
						</div>
					</div>
					<div class="resultCol">
						<div>
							<div><i18n-t keypath="mvp_rate_per_battle" scope="global"><template v-slot:img_mvp><img src="assets/stats/MVP.png" alt="MVP"/></template></i18n-t>:</div>
							<table class="multi">
							<tr v-show="results.numNodes>1"><th>&nbsp;</th><th v-for="n in results.numNodes">{{n}}</th></tr>
							<tr v-for="n in 7" v-show="results.hasSF||n<7"><th><img :src="'assets/stats/F' + n + '.png'" :alt="$t('ship_n',[n])"/></th><td v-for="stat in results['mvp'+n]">{{stat}}</td></tr>
							<tr class="tableSpace" v-show="results.hasCF"></tr>
							<tr v-for="n in 6" v-show="results.hasCF"><th><img :src="'assets/stats/F' + n + '.png'" :alt="$t('ship_n',[n])"/></th><td v-for="stat in results['mvpE'+n]">{{stat}}</td></tr>
							</table>
						</div>
						<div>
							<div>{{$t('air_state_rate_per_battle')}}:</div>
							<table class="multi">
							<tr v-show="results.numNodes>1"><th>&nbsp;</th><th v-for="n in results.numNodes">{{n}}</th></tr>
							<tr><th><span class="air good">{{$t('air_state_ASP')}}</span></th><td v-for="stat in results.airASP">{{stat}}</td></tr>
							<tr><th><span class="air good">{{$t('air_state_AS')}}</span></th><td v-for="stat in results.airAS">{{stat}}</td></tr>
							<tr><th><span class="air">{{$t('air_state_AP')}}</span></th><td v-for="stat in results.airAP">{{stat}}</td></tr>
							<tr><th><span class="air bad">{{$t('air_state_AD')}}</span></th><td v-for="stat in results.airAD">{{stat}}</td></tr>
							<tr><th><span class="air bad">{{$t('air_state_AI')}}</span></th><td v-for="stat in results.airAI">{{stat}}</td></tr>
							</table>
						</div>
					</div>
					<div class="resultCol">
						<div>
							<div><i18n-t keypath="taiha_rate_per_battle" scope="global"><template v-slot:img_taiha><img src="assets/stats/taiha.png" :alt="$t('heavy_damage')"/></template></i18n-t>:</div>
							<table class="multi">
							<tr v-show="results.numNodes>1"><th>&nbsp;</th><th v-for="n in results.numNodes">{{n}}</th></tr>
							<tr><th>{{$t('any')}}</th><td v-for="stat in results.taiha"><span class="resultBold">{{stat}}</span></td></tr>
							<tr class="tableSpace"></tr>
							<tr v-for="n in 7" v-show="results.hasSF||n<7"><th><img :src="'assets/stats/F' + n + '.png'" :alt="$t('ship_n',[n])"/></th><td v-for="stat in results['taiha'+n]">{{stat}}</td></tr>
							<tr class="tableSpace" v-show="results.hasCF"></tr>
							<tr v-for="n in 6" v-show="results.hasCF"><th><img :src="'assets/stats/F' + n + '.png'" :alt="$t('ship_n',[n])"/></th><td v-for="stat in results['taihaE'+n]">{{stat}}</td></tr>
							</table>
						</div>
						<div>
							<div><i18n-t keypath="no_chuuha_after_battle" scope="global"><template v-slot:img_chuuha><img src="assets/stats/chuuha.png" :alt="$t('moderate_damage')"/></template></i18n-t>:</div>
							<table class="multi">
							<tr v-show="results.numNodes>1"><th>&nbsp;</th><th v-for="n in results.numNodes">{{n}}</th></tr>
							<tr><th>{{$t('all')}}</th><td v-for="stat in results.noChuuha">{{stat}}</td></tr>
							</table>
						</div>
					</div>
					<div class="resultCol">
						<div>
							<div><span class="tooltip" :title="$t('avg_resupply_tooltip')">{{$t('avg_resupply')}}</span>:</div>
							<table>
							<tr><th><img src="assets/stats/fuel.png" :alt="$t('fuel')"/></th><td>{{results.fuelSupply}}</td></tr>
							<tr><th><img src="assets/stats/ammo.png" :alt="$t('ammo')"/></th><td>{{results.ammoSupply}}</td></tr>
							<tr><th><img src="assets/stats/baux.png" :alt="$t('baux')"/></th><td>{{results.bauxSupply}}</td></tr>
							</table>
						</div>
						<div>
							<div>{{$t('avg_repair')}}:</div>
							<table>
							<tr><th><img src="assets/stats/fuel.png" :alt="$t('fuel')"/></th><td>{{results.fuelRepair}}</td></tr>
							<tr><th><img src="assets/stats/steel.png" :alt="$t('steel')"/></th><td>{{results.steelRepair}}</td></tr>
							<tr><th><img src="assets/stats/bucket.png" :alt="$t('bucket')"/></th><td>{{results.bucket}}</td></tr>
							<tr><th><img src="assets/items/14.png" :alt="$t('repair_team')"/></th><td>{{results.damecon}}</td></tr>
							</table>
						</div>
						<div>
							<div>
								<i18n-t keypath="avg_resource_per" scope="global">
									<template v-slot:avg_res><span class="tooltip" :title="$t('avg_resource_tooltip')">{{$t('avg_resource')}}</span></template>
									<template v-slot:img><img src="assets/stats/S.png" alt="S"/></template>
								</i18n-t>:
								<img @click="onclickCopyResults('S')" src="assets/stats/content-copy-custom.png" class="copyIcons" :title="$t('copy_to_clipboard')"/>
							</div>
							<table>
							<tr><th><img src="assets/stats/fuel.png" :alt="$t('fuel')"/></th><td><span class="resultBold">{{results.fuelS}}</span></td></tr>
							<tr><th><img src="assets/stats/ammo.png" :alt="$t('ammo')"/></th><td><span class="resultBold">{{results.ammoS}}</span></td></tr>
							<tr><th><img src="assets/stats/steel.png" :alt="$t('steel')"/></th><td><span class="resultBold">{{results.steelS}}</span></td></tr>
							<tr><th><img src="assets/stats/baux.png" :alt="$t('baux')"/></th><td><span class="resultBold">{{results.bauxS}}</span></td></tr>
							<tr><th><img src="assets/stats/bucket.png" :alt="$t('bucket')"/></th><td><span class="resultBold">{{results.bucketS}}</span></td></tr>
							<tr><th><img src="assets/items/14.png" :alt="$t('repair_team')"/></th><td><span class="resultBold">{{results.dameconS}}</span></td></tr>
							</table>
						</div>
						<div>
							<div>
								<i18n-t keypath="avg_resource_per" scope="global">
									<template v-slot:avg_res><span class="tooltip" :title="$t('avg_resource_tooltip')">{{$t('avg_resource')}}</span></template>
									<template v-slot:img><img src="assets/stats/flagsunk.png" alt="$t('flagship_sunk')"/></template>
								</i18n-t>:
								<img @click="onclickCopyResults('flagsunk')" src="assets/stats/content-copy-custom.png" class="copyIcons" :title="$t('copy_to_clipboard')"/>
							</div>
							<table>
							<tr><th><img src="assets/stats/fuel.png" :alt="$t('fuel')"/></th><td><span class="resultBold">{{results.fuelSunk}}</span></td></tr>
							<tr><th><img src="assets/stats/ammo.png" :alt="$t('ammo')"/></th><td><span class="resultBold">{{results.ammoSunk}}</span></td></tr>
							<tr><th><img src="assets/stats/steel.png" :alt="$t('steel')"/></th><td><span class="resultBold">{{results.steelSunk}}</span></td></tr>
							<tr><th><img src="assets/stats/baux.png" :alt="$t('baux')"/></th><td><span class="resultBold">{{results.bauxSunk}}</span></td></tr>
							<tr><th><img src="assets/stats/bucket.png" :alt="$t('bucket')"/></th><td><span class="resultBold">{{results.bucketSunk}}</span></td></tr>
							<tr><th><img src="assets/items/14.png" :alt="$t('repair_team')"/></th><td><span class="resultBold">{{results.dameconSunk}}</span></td></tr>
							</table>
						</div>
						<div>
							<div>{{$t('avg_emptied_plane_slot')}}: {{results.emptiedPlane}}</div>
							<div>{{$t('avg_emptied_lbas_slot')}}: {{results.emptiedLBAS}}</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<hr>
		
		<div id="divNotice" v-show="showNoticeCount">{{noticeTxt}}</div>
	</div>
	
	<div id="divOther">
		<div id="divChangeLog">
			<div><span class="header">{{$t('change_log_header')}}:</span></div>
			<div v-for="(obj,idx) in $i18n.messages[$i18n.fallbackLocale].change_log">{{obj.date}} - <i18n-t :keypath="'change_log[' + idx + '].txt'" scope="global">
				<template v-for="(link,i) in obj.links" v-slot:['link'+i]><a :href="$t('change_log[' + idx + '].links[' + i + '].url')" target="_blank">{{$t('change_log[' + idx + '].links[' + i + '].txt')}}</a></template>
			</i18n-t></div>
		</div>
		<div id="divFooter">
			<div><i18n-t keypath="bug_reports_feature_requests" scope="global">
				<template v-slot:link_github><a href="https://github.com/KC3Kai/kancolle-replay/issues">Github</a></template>
				<template v-slot:link_discord><a href="https://discord.gg/RtSadWM">English KC Discord</a></template>
			</i18n-t></div>
		</div>
	</div>
	
	<template id="tmpBattle">
		<div class="battleWrap" :class="battleClass">
			<div class="deleteB" v-show="candelete" @click="onclickDeleteBattle"><div>&#10006;</div></div>
			<div><span class="headerMain">{{$t('node_n',[battle.ind+1])}}</span></div>
			<div class="settings">
				<div>
					<div><span class="header">{{$t('battle_type')}}:</span></div>
					<div class="nodeTypeWrap">
						<label><input type="radio" value="1" v-model="battle.nodeType" /><img src="assets/maps/nodeR.png" :title="$t('battle_normal')" /></label>
						<label><input type="radio" value="2" v-model="battle.nodeType" /><img src="assets/maps/nodeN.png" :title="$t('battle_night_only')" /></label>
						<label><input type="radio" value="6" v-model="battle.nodeType" /><img src="assets/maps/nodeRaid.png" :title="$t('battle_air_raid')" /></label>
						<label><input type="radio" value="4" v-model="battle.nodeType" /><img src="assets/maps/nodeAir.png" :title="$t('battle_air_only')" /></label>
					</div>
					<div v-show="hasNB"><label><input type="checkbox" v-model="battle.doNB" /><img src="assets/stats/nightbattle.png"/>{{$t('night_battle')}}</label></div>
					<div v-show="hasNB && battle.doNB"><label><select v-model="battle.doNBCond">
						<option value="">{{$t('always_if_possible')}}</option>
						<option value="A">{{$t('only_day_rank_less_than_A')}}</option>
						<option value="B">{{$t('only_day_rank_less_than_B')}}</option>
						<option value="flagsunk">{{$t('only_flag_not_sunk')}}</option>
					</select></label></div>
				</div>
				<div>
					<div><span class="header">{{$t('resupply_cost')}}:</span></div>
					<div><label><input type="checkbox" v-model="battle.subOnly"/>{{$t('submarine_only')}}</label></div>
					<div class="space"><span class="header">{{$t('add_cost')}}:</span></div>
					<div><label><img src="assets/stats/fuel.png" /><input type="number" min="0" max="100" v-model="battle.addCostFuel"/>%</label></div>
					<div><label><img src="assets/stats/ammo.png" /><input type="number" min="0" max="100" v-model="battle.addCostAmmo"/>%</label></div>
					<div><label><span class="tooltip" :title="$t('add_cost_max_tooltip')">{{$t('add_cost_max')}}</span>: <input type="number" min="0" max="999" v-model="battle.addCostMax" list="dlMaestromCost"/></label></div>
					<datalist id="dlMaestromCost">
						<option value="15">6-2-D</option>
						<option value="20">1-3-H</option>
						<option value="30">2-4-C, 3-2-G</option>
						<option value="40">3-3-C, 3-3-F</option>
						<option value="60">4-3-E</option>
						<option value="70">3-4-F, 7-2-A, 5-2-A, 5-3-L</option>
						<option value="80">5-5-D</option>
						<option value="100">4-5-R, 5-2-M</option>
						<option value="120">5-4-K, 5-5-L</option>
						<option value="150">2-5-G</option>
					</datalist>
				</div>
				<div>
					<div><span class="header">{{$t('player_formation')}}:</span></div>
					<div class="formationsWrap" v-show="!hasCombinedFormations">
						<label><input type="radio" value="1" v-model="battle.formation" /><img src="assets/stats/form1.jpg" /></label>
						<label><input type="radio" value="2" v-model="battle.formation" /><img src="assets/stats/form2.jpg" /></label>
						<label><input type="radio" value="3" v-model="battle.formation" /><img src="assets/stats/form3.jpg" /></label>
						<label><input type="radio" value="4" v-model="battle.formation" /><img src="assets/stats/form4.jpg" /></label>
						<label><input type="radio" value="5" v-model="battle.formation" /><img src="assets/stats/form5.jpg" /></label>
						<label><input type="radio" value="6" v-model="battle.formation" /><img src="assets/stats/form6.jpg" /></label>
					</div>
					<div class="formationsWrap" v-show="hasCombinedFormations">
						<label><input type="radio" value="11" v-model="battle.formation" /><img src="assets/stats/form11.png" /></label>
						<label><input type="radio" value="12" v-model="battle.formation" /><img src="assets/stats/form12.png" /></label>
						<label><input type="radio" value="13" v-model="battle.formation" /><img src="assets/stats/form13.png" /></label>
						<label><input type="radio" value="14" v-model="battle.formation" /><img src="assets/stats/form14.png" /></label>
					</div>
					<div class="space" v-show="hasSpecialAttack()">
						<label><input type="checkbox" v-model="battle.formationUseLAIfNoSpAttack"/> <i18n-t keypath="use_form_if_special_impossible" scope="global">
							<template v-slot:img_form>
								<img src="assets/stats/form1.jpg" :alt="$t('line_ahead')" v-show="!hasCombinedFormations"/>
								<img src="assets/stats/form14.png" :alt="$t('CF4')" v-show="hasCombinedFormations"/>
							</template>
						</i18n-t></label>
					</div>
				</div>
				<div>
					<div><span class="header">{{$t('lbas_waves')}}:</span></div>
					<div>1 <input type="checkbox" v-model="battle.lbasWaves[0]" @change="onchangeLbasWaves(0)"/><input type="checkbox" v-model="battle.lbasWaves[1]" @change="onchangeLbasWaves(0)"/></div>
					<div>2 <input type="checkbox" v-model="battle.lbasWaves[2]" @change="onchangeLbasWaves(1)"/><input type="checkbox" v-model="battle.lbasWaves[3]" @change="onchangeLbasWaves(1)"/></div>
					<div>3 <input type="checkbox" v-model="battle.lbasWaves[4]" @change="onchangeLbasWaves(2)"/><input type="checkbox" v-model="battle.lbasWaves[5]" @change="onchangeLbasWaves(2)"/></div>
					<div class="space" v-show="isboss"><span class="header">{{$t('support')}}:</span></div>
					<div class="formationsWrap" v-show="isboss">
						<label><input type="radio" value="1" v-model.number="battle.useNormalSupport" />{{$t('support_normal')}}</label>
						<label><input type="radio" value="0" v-model.number="battle.useNormalSupport" />{{$t('support_boss')}}</label>
					</div>
					<div class="space"><label><input type="checkbox" v-model="battle.useSmoke"/><img src="assets/items/54.png" :title="$t('use_smokescreen')"/></label></div>
					<div><label><input type="checkbox" v-model="battle.useBalloon"/><img src="assets/items/55.png" :title="$t('enable_barrage_balloon_effects')"/></label></div>
					<div><label><input type="checkbox" v-model="battle.useAtoll"/><img style="width:36px" src="assets/LC14.png" :title="$t('enable_atoll_node_effects')"/></label></div>
					<div class="space"><label><input type="checkbox" v-model="battle.useAnchorageRepair"/><img src="assets/stats/item91.png" :title="$t('use_anchorage_repair_before_battle')"/></label></div>
				</div>
				<div>
					<div><span class="header">{{$t('override_historical_bonuses')}}:</span></div>
					<div><input type="button" :value="$t('set_bonuses')" @click="onclickSetBonus"/></div>
					<div v-show="hasBonusMain()" class="bonusMarker main" :title="$t('main_fleet_set')">&#11044;</div>
					<div v-show="hasBonusLBAS()" class="bonusMarker lbas" :title="$t('lbas_set')">&#11044;</div>
					<div v-show="hasBonusFF()" class="bonusMarker friend" :title="$t('friend_fleet_set')">&#11044;</div>
					<div><input type="button" :value="$t('import_bonuses_once')" @click="onclickImportBonus"/></div>
				</div>
			</div>
			<div ref="comps"><vfleetcomps :comps="battle.enemyComps" :fleetname="$t('enemy_fleet')" canimportkcnav="1"></vfleetcomps></div>
		</div>
	</template>
	
	<template id="tmpFleetComps">
		<div>
			<div v-for="comp in comps" class="fleetComp" :ref="'comp'+comp.num">
				<vfleet :fleet="comp.fleet" :fleetname="$t('fleet_comp_num',[fleetname,comp.num])"></vfleet>
				<div class="rate">
					<div><input type="number" v-model="comp.rate" min="0" :title="$t('weight')"/></div>
					<div>({{getCompPercent(comp)}}%)</div>
				</div>
			</div>
		</div>
		<div class="fleetCompAdd">
			<div>
				<input type="button" :value="$t('import_kcnav')" @click="onclickImportKCNav" v-show="canimportkcnav"/>&nbsp;
				<input type="button" value="+" :style="{visibility:canAddComp?'':'hidden'}" @click="onclickAddComp"/><input type="button" value="&#8722;" :style="{visibility:comps.length>1?'':'hidden'}" @click="onclickRemoveComp"/>
			</div>
		</div>
	</template>
	
	<template id="tmpFleet">
		<div class="fleet" :class="fleetClass">
			<div class="preview" @click="onclickExpand">
				<div class="header" ref="header">
					<div>{{fleetname}}</div>
					<div class="expand">
						<span v-show="!expanded">[+]</span>
						<span v-show="expanded">[&#8722;]</span>
					</div>
				</div>
				<div class="iconsWrap" v-show="!expanded">
					<div v-for="ship in fleet.ships" class="icon" v-show="ship.ind<numShipShow">
						<div class="iconOverlay" v-show="hasStatChanged(ship)"><div class="circle" :title="$t('ship_has_customised_stats')">&#11044;</div></div>
						<div class="iconOverlay" v-show="hasStatDebuff(ship)"><div class="debuff" :title="$t('ship_has_customised_stats')"><img src="assets/stats/ar.png"/></div></div>
						<div class="iconOverlay" v-show="hasStatUnknown(ship,[3]) && !hasStatUnknown(ship,[1,2])"><div class="exclamation med" :title="$t('ship_has_unknown_stats')">!</div></div>
						<div class="iconOverlay" v-show="hasStatUnknown(ship,[1,2])"><div class="exclamation high" :title="$t('ship_has_unknown_stats')">!</div></div>
						<img :src="'assets/icons/' + ship.imgName" />
					</div>
					<div class="iconForm" v-show="!expanded&&fleet.isEnemy">
						<img v-if="!fleet.combined" :src="'assets/stats/form'+fleet.formation+'.jpg'"/>
						<img v-if="fleet.combined" :src="'assets/stats/form'+fleet.formation+'.png'"/>
					</div>
				</div>
				<div class="iconsWrap" v-show="!expanded && fleet.combined" v-if="fleet.shipsEscort">
					<div v-for="ship in fleet.shipsEscort" class="icon" v-show="ship.ind<numShipShow">
						<div class="iconOverlay" v-show="hasStatChanged(ship)"><div class="circle" :title="$t('ship_has_customised_stats')">&#11044;</div></div>
						<div class="iconOverlay" v-show="hasStatDebuff(ship)"><div class="debuff" :title="$t('ship_has_customised_stats')"><img src="assets/stats/ar.png"/></div></div>
						<div class="iconOverlay" v-show="hasStatUnknown(ship,[3]) && !hasStatUnknown(ship,[1,2])"><div class="exclamation med" :title="$t('ship_has_unknown_stats')">!</div></div>
						<div class="iconOverlay" v-show="hasStatUnknown(ship,[1,2])"><div class="exclamation high" :title="$t('ship_has_unknown_stats')">!</div></div>
						<img :src="'assets/icons/' + ship.imgName" />
					</div>
				</div>
			</div>
			<div class="editor" ref="editor"></div>
		</div>
	</template>
	
	
	
	
	<div id="divFleetEditorTemp"><div id="divFleetEditor" class="fleetEditor">
	<div v-show="active">
		<div id="divFleetEditorImport">
			<div class="headerImport">{{$t('load_options')}}:</div>
			<div>
				<div class="headerSubImport">{{$t('from_text')}}:</div>
				<div><textarea cols="20" rows="2" autocomplete="off" v-model="loadCode" @focus="onfocusCode" @click="onclickSelectAll" :title="$t('from_text_note')"></textarea></div>
				<div>
					<input type="button" :value="$t('load')" @click="onclickLoadCode"/>
					<span v-show="codeIsDeckbuilder"> {{$t('fleet')}}: <select v-model.number="loadCodeFleet">
						<option v-for="n in 4" :value="n">{{n}}</option>
						<option v-if="fleet.isEnemy" value="11">1+2</option>
						<option v-if="fleet.isPlayer" value="11">1+2 {{$t('CTF')}}</option>
						<option v-if="fleet.isPlayer" value="12">1+2 {{$t('STF')}}</option>
						<option v-if="fleet.isPlayer" value="13">1+2 {{$t('TCF')}}</option>
					</select></span>
				</div>
			</div>
			<div>
				<div class="headerSubImport">{{$t('from_kc3_file')}} (<a href="#" @click.prevent="showKC3ProfileHelp=true">?</a>):</div>
				<div><input type="file" accept=".kc3" ref="inputLoadKC3" @change="onchangeFileKC3"/></div>
				<div>{{$t('fleet')}}: <select v-model="loadKC3Fleet"><option v-for="n in 4" :value="n">{{n}}</option><option value="10" v-show="canCF">1+2</option></select> <input type="button" value="Load" @click="onclickLoadKC3"/></div>
			</div>
			<div class="importPreset">
				<div class="headerSubImport">{{$t('from_preset')}}:</div>
				<div>
					<select v-model="loadPresetArea" @change="onchangePresetArea">
						<option></option>
						<optgroup v-for="g in presetListArea" :label="$t('area.' + g.name)"><option v-for="o in g.options" :value="o.value">{{o.name}}</option></optgroup>
					</select>
					<select v-model="loadPresetNode" v-show="loadPresetArea" @change="onchangePresetNode"><option v-for="o in presetListNode" :value="o.value">{{o.name}}</option></select>
					<select v-model="loadPresetComp" v-show="loadPresetArea" @change="onchangePreset"><option v-for="o in presetListComp" :value="o.value">{{o.name}}</option></select>
				</div>
			</div>
			<div class="importOther">
				<div><input type="button" :value="$t('clear_all')" @click="onclickReset"/></div>
				<div class="importBottom"><input type="button" :value="$t('export_deckbuilder')" @click="onclickExportDb"/></div>
			</div>
		</div>
		
		<div v-for="keyS in ['ships','shipsEscort']"><div v-if="fleet[keyS]" v-show="keyS=='ships' || fleet.combined">
			<div class="shipWrap">
				<div v-for="ship in fleet[keyS]" :class="{shipMain:1,even:ship.ind%2}" v-show="ship.ind<numShipShow">
					<div class="shipHeader"><img :src="'assets/stats/F' + (ship.ind+1) + '.png'" /></div>
					<div class="shipName">
						<input :value="$t('ship_name_'+(ship.name||'0'))" :ref="keyS+ship.ind" :title="$t('ship_name_'+(ship.name||'0')) + ' (' + ship.mstId + ')'" tabindex="10" spellcheck="false" readonly @click="onclickShip(ship,keyS)" @keypress="onkeypressShip($event,ship,keyS)" @dragover.prevent="" />
						<div class="delete" @click="onclickDeleteShip(ship,keyS)">&#10006;</div>
					</div>
					<div class="shipBanner"><img :src="'assets/icons/' + ship.imgName" @dragstart="ondragstartShip(ship,keyS)" @dragover.prevent="" @drop.prevent="ondropShip(ship,keyS)" @dragend="ondragendShip" /></div>
					<div class="shipStatWrap" v-if="ship.mstId">
						<div class="statHalf"><img src="assets/stats/lv.png" :title="$t('stat_level')"/><input type="number" v-model.number="ship.level" min="1" max="999" @change="onchangeStat($event,ship,'level');onchangeLevel(ship)"/></div>
						<div class="statHalf"><img src="assets/stats/hp.png" :title="$t('stat_HP')"/><input type="number" v-model.number="ship.hp" min="1" max="9999" @change="onchangeStat($event,ship,'hp');onchangeHP(ship)"/></div>
						<div v-for="stat in statBList" class="statHalf">
							<img :src="'assets/stats/' + stat.key + '.png'" :title="$t('stat_' + stat.name)"/>
							<input type="number" v-model.number="ship.statsBase[stat.key]" min="0" max="999"
								:class="getClassStat(ship,stat.key)" :title="$t(getTitleStat(ship,stat.key))"
								@change="onchangeStat($event,ship.statsBase,stat.key)"/>
							<span v-show="showStatTotal">
								<span>{{getStatTotal(ship,stat.key)}}</span>
								<span class="statBonus" v-show="showEquipBonus && ship.statsBonus[stat.key] > 0">(+{{ship.statsBonus[stat.key]}})</span>
								<span class="statBonus negative" v-show="showEquipBonus && ship.statsBonus[stat.key] < 0">({{ship.statsBonus[stat.key]}})</span>
							</span>
						</div>
						<div class="statHalf"><img src="assets/stats/lk.png" :title="$t('stat_luck')"/><input type="number" v-model.number="ship.statsBase.luk" min="0" max="999"
							:class="getClassStat(ship,'luk')" :title="$t(getTitleStat(ship,'luk'))"
							@change="onchangeStat($event,ship.statsBase,'luk')"/></div>
						<div class="statHalf">
							<img src="assets/stats/rn.png" :title="$t('stat_range')"/><input type="number" v-model.number="ship.statsBase.range" min="0" max="9" @change="onchangeStat($event,ship.statsBase,'range')"/>
							<span v-show="showStatTotal">
								<span>{{getStatTotal(ship,'range')}}</span>
								<span class="statBonus" v-show="showEquipBonus && ship.statsBonus.range">(+{{ship.statsBonus.range}})</span>
							</span>
						</div>
						<div class="statHalf" v-show="showStatTotal">
							<img src="assets/stats/divebomb.png" :title="$t('stat_divebomb')"/><input type="number" style="visibility:hidden"/>
							<span>
								<span>{{getStatTotal(ship,'divebomb')}}</span>
								<span class="statBonus" v-show="showEquipBonus && ship.statsBonus.divebomb > 0">(+{{ship.statsBonus.divebomb}})</span>
								<span class="statBonus negative" v-show="showEquipBonus && ship.statsBonus.divebomb < 0">({{ship.statsBonus.divebomb}})</span>
							</span>
						</div>
						<div class="statHalf" v-show="showStatTotal">
							<img src="assets/stats/acc.png" :title="$t('stat_accuracy')"/><input type="number" style="visibility:hidden"/>
							<span>
								<span>{{getStatTotal(ship,'acc')}}</span>
								<span class="statBonus" v-show="showEquipBonus && ship.statsBonus.acc > 0">(+{{ship.statsBonus.acc}})</span>
								<span class="statBonus negative" v-show="showEquipBonus && ship.statsBonus.acc < 0">({{ship.statsBonus.acc}})</span>
							</span>
						</div>
						<div class="statHalf">
							<img src="assets/stats/rm.png" :title="$t('stat_torpedo_accuracy')"/>
							<input type="number" v-model.number="ship.statsBase.tacc" min="0" max="999" :class="getClassStat(ship,'tacc')" :title="$t(getTitleStat(ship,'tacc'))" @change="onchangeStat($event,ship.statsBase,'tacc')"/>
						</div>
						
						<div class="bonusWrap" v-show="canBonus">
							<div v-show="$t('bonus_header').length">{{$t('bonus_header')}}:</div>
							<div class="statWide"><span :title="$t('bonus_dmg_desc')"><i18n-t keypath="bonus_dmg" scope="global">
								<template v-slot:br><br></template>
							</i18n-t>:</span><input type="number" v-model.number="ship.bonusDmg" min="0" max="99" step="any" @change="onchangeStat($event,ship,'bonusDmg',1)"/></div>
							<div class="statWide"><span :title="$t('bonus_acc_desc')"><i18n-t keypath="bonus_acc" scope="global">
								<template v-slot:br><br></template>
							</i18n-t>:</span><input type="number" v-model.number="ship.bonusAcc" min="0" max="99" step="any" @change="onchangeStat($event,ship,'bonusAcc',1)"/></div>
							<div class="statWide"><span :title="$t('bonus_eva_desc')"><i18n-t keypath="bonus_eva" scope="global">
								<template v-slot:br><br></template>
							</i18n-t>:</span><input type="number" v-model.number="ship.bonusEva" min="0" max="99" step="any" @change="onchangeStat($event,ship,'bonusEva',1)"/></div>
							<div class="statWide" v-show="fleet.isFriend"><span class="statDebuff" :title="$t('debuff_dmg_desc')"><i18n-t keypath="debuff_dmg" scope="global">
								<template v-slot:br><br></template>
							</i18n-t>:</span><input type="number" v-model.number="ship.bonusDmgDebuff" min="0" max="99" step="any" @change="onchangeStat($event,ship,'bonusDmgDebuff',1)"/></div>
							<div class="statWide">
								<input type="button" :value="$t('plane_bonus_ship')" :disabled="!getShipHasPlane(ship)" @click="onclickPlaneBonus(ship)"/>&nbsp;
								<div v-show="getShipHasPlaneBonus(ship)" class="bonusMarker plane">&#11044;</div>
							</div>
						</div>
						
						<div class="equipWrap">
							<div v-for="equip in ship.equips">
								<div class="equipName">
									<input :value="$t('equip_name_'+(equip.name||'0'))" :ref="keyS+ship.ind+'_'+equip.ind" :title="$t('equip_name_'+(equip.name||'0')) + ' (' + equip.mstId + ')'" spellcheck="false" readonly @click="onclickEquip(ship,equip,keyS)" @keypress="onkeypressEquip($event,ship,equip,keyS)" @dragover.prevent="" />
									<div class="delete" @click="onclickDeleteEquip(ship,equip,keyS)">&#10006;</div>
								</div>
								<div class="equipOptions">
									<img src="assets/items/0.png" />
									<img class="equipIcon" :src="'assets/items/' + equip.imgName + '.png'" @dragstart="ondragstartEquip(ship,equip,keyS)" @dragover.prevent="" @drop.prevent="ondropEquip(ship,equip)" @dragend="ondragendEquip"/>
									<input class="equipCarry" type="number" v-model.number="ship.slots[equip.ind]" min="0" max="999" :title="$t('slot_size')" @change="onchangeStat($event,ship.slots,equip.ind)"/>
									<select :class="{equipRank:1,rankBlue:equip.rank&&equip.rank<4,rankGold:equip.rank>=4}" v-show="equip.mstId && equip.isPlane" v-model.number="equip.rank" :title="$t('proficiency')">
										<option value="0"></option>
										<option value="1" class="rankBlue">|</option>
										<option value="2" class="rankBlue">||</option>
										<option value="3" class="rankBlue">|||</option>
										<option value="4" class="rankGold">\</option>
										<option value="5" class="rankGold">\\</option>
										<option value="6" class="rankGold">\\\</option>
										<option value="7" class="rankGold">&gt;&gt;</option>
									</select>
									<div class="equipLevel" v-show="equip.mstId"><span>&#9733;</span><select v-model.number="equip.level" :title="$t('improvement')" @change="onchangeEquipLevel(ship)"><option value="0"></option><option v-for="n in 10" :value="n">{{n}}</option></select></div>
								</div>
							</div>
						</div>
						
						<div class="statWide"><img src="assets/stats/hp.png" :title="$t('hp_init')"/> {{$t('init')}}: <input type="number" :title="getRepairStr(ship)" v-model.number="ship.hpInit" min="1" :max="ship.hp" :class="getClassHP(ship)" @change="onchangeStat($event,ship,'hpInit')"/></div>
						<div class="statWide">{{$t('morale')}}: <input type="number" v-model.number="ship.morale" min="0" max="100" :class="getClassMorale(ship)" @change="onchangeStat($event,ship,'morale')"/></div>
						<div class="statHalf" :title="getFuel(ship)+'/'+getFuelMax(ship)"><img src="assets/stats/fuel.png" :title="$t('fuel_percent')"/><input type="number" v-model.number="ship.fuelInit" min="0" max="100" @change="onchangeStat($event,ship,'fuelInit')"/></div>
						<div class="statHalf" :title="getAmmo(ship)+'/'+getAmmoMax(ship)"><img src="assets/stats/ammo.png" :title="$t('ammo_percent')"/><input type="number" v-model.number="ship.ammoInit" min="0" max="100" @change="onchangeStat($event,ship,'ammoInit')"/></div>
						<div class="statWide" v-show="fleet.isEnemy"><label><img src="assets/maps/nodeAirSub.png" :title="$t('air_sub_node')" style="height:20px"/> {{$t('air_sub_support')}}: <input type="checkbox" v-model="ship.isFaraway"/></label></div>
					</div>
				</div>
			</div>
			<div class="fleetEditorAddl">
				<label><input type="checkbox" v-model="showStatTotal"/>{{$t('show_equipped_stats')}}</label>
				<label><input type="checkbox" v-model="autoScaleStats"/><i18n-t keypath="autoscale_stats" scope="global">
					<template v-slot:img_hp><img src="assets/stats/hp.png"/></template>
					<template v-slot:img_ev><img src="assets/stats/ev.png"/></template>
					<template v-slot:img_asw><img src="assets/stats/asw.png"/></template>
					<template v-slot:img_los><img src="assets/stats/los.png"/></template>
					<template v-slot:img_lv><img src="assets/stats/lv.png"/></template>
				</i18n-t></label>
				<label><input type="checkbox" v-model="preserveBonus"/>{{$t('preserve_bonus_on_change')}}</label>
				<input type="button" :value="$t('show_additional_stats')" @click="onclickAdditionalStats(keyS)" />
			</div>
		</div></div>
		<div id="divFleetEditorFleet" v-show="!fleet.isSupport">
			<div id="divFleetEditorType">
				<label><input type="radio" value="0" v-model="fleet.type" @change="onchangeType" /><img src="assets/maps/ship.png" :title="$t('single_fleet')" /></label>
				<label v-show="canCF"><input type="radio" value="1" v-model="fleet.type" @change="onchangeType" /><img src="assets/stats/combine1.png" :title="fleet.isEnemy ? $t('combined_fleet') : $t('carrier_task_force')" /></label>
				<label v-show="canCFAll"><input type="radio" value="2" v-model="fleet.type" @change="onchangeType" /><img src="assets/stats/combine2.png" :title="$t('surface_task_force')" /></label>
				<label v-show="canCFAll"><input type="radio" value="3" v-model="fleet.type" @change="onchangeType" /><img src="assets/stats/combine3.png" :title="$t('transport_combined_fleet')" /></label>
				<label v-show="canSF"><input type="radio" value="7" v-model="fleet.type" @change="onchangeType" /><img src="assets/maps/shipIconSF.png" :title="$t('strike_force')" /></label>
			</div>
			<div id="divFleetEditorForm" v-show="canFormation">
				<label v-show="!fleet.combined"><input type="radio" value="1" v-model="fleet.formation" /><img src="assets/stats/form1.jpg" /></label>
				<label v-show="!fleet.combined"><input type="radio" value="2" v-model="fleet.formation" /><img src="assets/stats/form2.jpg" /></label>
				<label v-show="!fleet.combined"><input type="radio" value="3" v-model="fleet.formation" /><img src="assets/stats/form3.jpg" /></label>
				<label v-show="!fleet.combined"><input type="radio" value="4" v-model="fleet.formation" /><img src="assets/stats/form4.jpg" /></label>
				<label v-show="!fleet.combined"><input type="radio" value="5" v-model="fleet.formation" /><img src="assets/stats/form5.jpg" /></label>
				<label v-show="!fleet.combined"><input type="radio" value="6" v-model="fleet.formation" /><img src="assets/stats/form6.jpg" /></label>
				<label v-show="fleet.combined"><input type="radio" value="11" v-model="fleet.formation" /><img src="assets/stats/form11.png" /></label>
				<label v-show="fleet.combined"><input type="radio" value="12" v-model="fleet.formation" /><img src="assets/stats/form12.png" /></label>
				<label v-show="fleet.combined"><input type="radio" value="13" v-model="fleet.formation" /><img src="assets/stats/form13.png" /></label>
				<label v-show="fleet.combined"><input type="radio" value="14" v-model="fleet.formation" /><img src="assets/stats/form14.png" /></label>
			</div>
		</div>
		<div style="margin:10px">
			<label>{{$t('set_all_morale_to')}}: </label><input type="button" value="49" @click="onclickSetMoraleAll(49)"/> <input type="button" value="85" @click="onclickSetMoraleAll(85)"/>
		</div>
	</div>
	<div v-show="showKC3ProfileHelp">
		<vmodal @vclose="showKC3ProfileHelp=false">
		<div id="divKC3ProfileHelp">
			<div>{{$t('kc3kai_import_desc_0')}}</div>
			<div>1. {{$t('kc3kai_import_desc_1')}}</div>
			<div>2. <span class="bold">{{$t('kc3kai_import_desc_2')}}</span></div>
			<div>3. {{$t('kc3kai_import_desc_3')}}</div>
			<div>4. <i18n-t keypath="kc3kai_import_desc_4" scope="global"><template v-slot:txt_b><span class="bold">{{$t('kc3kai_import_desc_4_b')}}</span></template></i18n-t></div>
			<div>5. {{$t('kc3kai_import_desc_5')}}</div>
		</div>
		</vmodal>
	</div>
	</div></div>
	
	
	<template id="tmpLBASEditor">
		<div class="fleetEditor">
			<div class="shipWrap">
				<div v-for="base in bases" :class="{shipMain:1,even:base.ind%2}">
					<div class="equipWrap">
						<div v-for="equip in base.equips">
							<div class="equipName">
								<input :value="$t('equip_name_'+(equip.name||'0'))" :ref="base.ind+'_'+equip.ind" :title="$t('equip_name_'+(equip.name||'0')) + ' (' + equip.mstId + ')'" spellcheck="false" readonly @click="onclickEquip(base,equip)" @keypress="onkeypressEquip($event,base,equip)" @dragover.prevent="" />
								<div class="delete" @click="onclickDeleteEquip(base,equip)">&#10006;</div>
							</div>
							<div class="equipOptions">
								<img src="assets/items/0.png" />
								<img class="equipIcon" :src="'assets/items/' + equip.imgName + '.png'" @dragstart="ondragstartEquip(base,equip)" @dragover.prevent="" @drop.prevent="ondropEquip(base,equip)" @dragend="ondragendEquip"/>
								<input class="equipCarry" type="number" v-model.number="base.slots[equip.ind]" min="0" max="999" :title="$t('slot_size')" @change="onchangeStat($event,base.slots,equip.ind)"/>
								<select :class="{equipRank:1,rankBlue:equip.rank&&equip.rank<4,rankGold:equip.rank>=4}" v-show="equip.mstId && equip.isPlane" v-model.number="equip.rank" :title="$t('proficiency')">
									<option value="0"></option>
									<option value="1" class="rankBlue">|</option>
									<option value="2" class="rankBlue">||</option>
									<option value="3" class="rankBlue">|||</option>
									<option value="4" class="rankGold">\</option>
									<option value="5" class="rankGold">\\</option>
									<option value="6" class="rankGold">\\\</option>
									<option value="7" class="rankGold">&gt;&gt;</option>
								</select>
								<div class="equipLevel" v-show="equip.mstId"><span>&#9733;</span><select v-model.number="equip.level" :title="$t('improvement')"><option value="0"></option><option v-for="n in 10" :value="n">{{n}}</option></select></div>
							</div>
							<div class="shipStatWrap"><div class="bonusWrap">
								<div class="statWide"><span :title="$t('bonus_dmg_desc')"><i18n-t keypath="bonus_dmg" scope="global">
								<template v-slot:br><br></template>
							</i18n-t>:</span><input type="number" v-model.number="equip.bonusDmg" min="0" max="99" step="any" :disabled="!equip.mstId" @change="onchangeStat($event,equip,'bonusDmg',1)"/></div>
							</div></div>
							<div class="shipStatWrap"><div class="bonusWrap">
								<div class="statWide"><span :title="$t('bonus_acc_desc')"><i18n-t keypath="bonus_acc" scope="global">
								<template v-slot:br><br></template>
							</i18n-t>:</span><input type="number" v-model.number="equip.bonusAcc" min="0" max="99" step="any" :disabled="!equip.mstId" @change="onchangeStat($event,equip,'bonusAcc',1)"/></div>
							</div></div>
						</div>
					</div>
					<div style="display:flex;gap:5px">
						<input type="button" :value="$t('plane_bonus_lbas')" :disabled="!getBaseHasPlane(base)" @click="onclickPlaneBonus(base)"/>
						<span v-show="getBaseHasPlaneBonus(base)" class="bonusMarker plane">&#11044;</span>
					</div>
				</div>
			</div>
		</div>
		<div class="fleetEditorAddl">
			<input type="button" :value="$t('show_additional_stats_lbas')" @click="onclickAdditionalStats"/>
		</div>
	</template>
	
	
	<div id="divShipSel"><div v-show="active">
		<vmodal @vclose="doClose">
		<div id="divShipSelMain">
			<div id="divShipSelSearch" @keydown="onkeydownSearch" v-show="!buttonsChoice">
				<div><input ref="inputShipSelSearch" v-model="searchName" @input="oninputSearch" :placeholder="$t('ui_search')" /></div>
				<div id="divShipSelResults" v-show="searchResults.length">
					<div v-for="result in searchResults" :ref="result.ref" :class="{selectResult:1,selected:searchSelected==result.id}" @mouseover="onmouseoverResult(result)" @click="onclickResult(result)">
						{{result.namePre}}<span class="underlined">{{result.nameUnderline}}</span>{{result.namePost}}
					</div>
				</div>
			</div>
			<div id="divShipSelButtonsCat" v-show="!searchName.length && !buttonsChoice">
				<div>{{$t('selector.ship_section_Shipgirls')}}</div>
				<div class="buttonWrap">
					<div v-for="btn in buttonsCat1" class="selButton" @click="onclickButtonCat(btn)">
						<div><img :src="'assets/icons/' + btn.imgName" /></div>
						<div>{{$t('selector.ship_cat_'+btn.name)}}</div>
					</div>
				</div>
				<div>{{$t('selector.ship_section_Abyssals')}}</div>
				<div class="buttonWrap">
					<div v-for="btn in buttonsCat2" class="selButton" @click="onclickButtonCat(btn)">
						<div><img :src="'assets/icons/' + btn.imgName" /></div>
						<div>{{$t('selector.ship_cat_'+btn.name)}}</div>
					</div>
				</div>
				<div>{{$t('selector.ship_section_Extra')}}</div>
				<div class="buttonWrap">
					<div v-for="btn in buttonsCat3" :class="{selButton:1,secret:btn.secret}" @click="onclickButtonCat(btn)">
						<div v-if="btn.imgName"><img :src="'assets/icons/' + btn.imgName" /></div>
						<div>{{$t('selector.ship_cat_'+btn.name)}}</div>
					</div>
				</div>
			</div>
			<div v-show="!searchName.length && buttonsChoice">
				<div class="selButtonBack"><input type="button" :value="$t('ui_back')" @click="onclickBack"/></div>
				<div id="divShipSelButtonsShip">
					<div v-for="btn in buttonsChoice" class="selButton">
						<div @click="onclickButtonShip(btn)">
							<div><img :src="'assets/icons/' + btn.imgName" /></div>
							<div>{{btn.name}}</div>
						</div>
						<div class="remodelButtonWrap" v-if="btn.remodels">
							<div v-for="remodel in btn.remodels" class="remodelButton" @click="onclickButtonShipR(remodel)">{{remodel.name}}</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		</vmodal>
	</div></div>
	
	<div id="divEquipSel"><div v-show="active">
		<vmodal @vclose="doClose">
		<div id="divEquipSelMain">
			<div id="divEquipSelSearch" @keydown="onkeydownSearch" v-show="!buttonsChoice">
				<div><input ref="inputEquipSelSearch" v-model="searchName" @input="oninputSearch" :placeholder="$t('ui_search')" /></div>
				<div id="divEquipSelResults" v-show="searchResults.length">
					<div v-for="result in searchResults" :ref="result.ref" :class="{selectResult:1,selected:searchSelected==result.id}" @mouseover="onmouseoverResult(result)" @click="onclickResult(result)">
						<img :src="'assets/items/'+result.imgName+'.png'"/>{{result.namePre}}<span class="underlined">{{result.nameUnderline}}</span>{{result.namePost}}
					</div>
				</div>
			</div>
			<div id="divEquipSelButtonsCat" v-show="!searchName.length && !buttonsChoice">
				<div class="buttonWrap">
					<div v-for="btn in buttonsCat" class="selButton" @click="onclickButtonCat(btn)">
						<div><img v-for="imgName in btn.imgNames" :src="'assets/items/' + imgName + '.png'" /></div>
						<div>{{$t('selector.equip_cat_'+btn.name)}}</div>
					</div>
				</div>
			</div>
			<div v-show="buttonsChoice">
				<div class="selButtonBack"><input type="button" :value="$t('ui_back')" @click="onclickBack"/></div>
				<div id="divEquipSelButtonsEquip" v-if="buttonsChoice">
					<div>{{$t('selector.equip_section_Player')}}</div>
					<div class="equipButtonWrap">
						<div v-for="btn in buttonsChoice.player" class="equipButton" @click="onclickButtonEquip(btn)">
							<div><img :src="'assets/items/' + btn.imgName + '.png'" /></div>
							<div>
								<div>{{$t('equip_name_'+btn.name)}}</div>
								<span v-for="stat in btn.stats"><img :src="'assets/stats/' + stat.name + '.png'" />{{stat.num}}</span>
							</div>
						</div>
					</div>
					<div>{{$t('selector.equip_section_Abyssal')}}</div>
					<div class="equipButtonWrap">
						<div v-for="btn in buttonsChoice.enemy" class="equipButton" @click="onclickButtonEquip(btn)">
							<div><img :src="'assets/items/' + btn.imgName + '.png'" /></div>
							<div>
								<div>{{$t('equip_name_'+btn.name)}}</div>
								<span v-for="stat in btn.stats"><img :src="'assets/stats/' + stat.name + '.png'" />{{stat.num}}</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		</vmodal>
	</div></div>
	
	<div id="divBonusEditor"><div v-show="active">
		<vmodal :active="active" @vclose="doClose">
			<div id="divBonusEditorMain">
				<div v-show="shipGroups.length">
					<div v-for="ships in shipGroups" class="shipWrap">
						<div v-for="ship in ships" class="ship">
							<div><img :src="'assets/icons/' + ship.imgName"/></div>
							<div class="bonusWrap" v-if="ship.bonusByNode[nodeId]">
								<table>
								<tr>
									<td><i18n-t keypath="bonus_dmg" scope="global">
										<template v-slot:br><br></template>
									</i18n-t>:</td>
									<td><input type="number" min="0" max="99" step="any" :placeholder="ship.bonusDmg" v-model.number="ship.bonusByNode[nodeId].bonusDmg"/></td>
								</tr>
								<tr>
									<td><i18n-t keypath="bonus_acc" scope="global">
										<template v-slot:br><br></template>
									</i18n-t>:</td>
									<td><input type="number" min="0" max="99" step="any" :placeholder="ship.bonusAcc" v-model.number="ship.bonusByNode[nodeId].bonusAcc"/></td>
								</tr>
								<tr>
									<td><i18n-t keypath="bonus_eva" scope="global">
										<template v-slot:br><br></template>
									</i18n-t>:</td>
									<td><input type="number" min="0" max="99" step="any" :placeholder="ship.bonusEva" v-model.number="ship.bonusByNode[nodeId].bonusEva"/></td>
								</tr>
								<tr v-show="isBossNode">
									<td><span class="statDebuff" :title="$t('debuff_dmg_desc')"><i18n-t keypath="debuff_dmg" scope="global">
										<template v-slot:br><br></template>
									</i18n-t>:</span></td>
									<td><input type="number" min="0" max="99" step="any" v-model.number="ship.bonusDmgDebuff"/></td>
								</tr>
								<tr>
									<td colspan="2"><div style="display:flex;gap:5px">
										<input type="button" :value="$t('plane_bonus_ship')" :disabled="!getShipHasPlane(ship)" @click="onclickPlaneBonus(ship)"/>
										<span v-show="getShipHasPlaneBonusMapwide(ship)" class="bonusMarker plane overridable">&#11044;</span>
										<span v-show="getShipHasPlaneBonus(ship)" class="bonusMarker plane">&#11044;</span>
									</div></td>
								</tr>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</vmodal>
	</div></div>
	
	
	<div id="divAdditionalStats"><div v-show="active">
		<vmodal :active="active" @vclose="doClose">
		<div id="divAdditionalStatsMain" class="additionalStatsMain">
			<div>{{$t('fleet_air_power')}}: {{fleet.airPower}} (<span v-show="fleet.airPowerCombined">{{$t('fleet_air_power_combined')}} = {{fleet.airPowerCombined}}, </span>{{$t('fleet_air_power_lbas')}} = {{fleet.airPowerLB}})&nbsp;&nbsp;&nbsp;&nbsp;{{$t('transport')}}: {{fleet.transport}}</div>
			<div>{{$t('effective_los')}}: C1 = {{fleet.los1}}, C2 = {{fleet.los2}}, C3 = {{fleet.los3}}, C4 = {{fleet.los4}}</div>
			<table>
			<tr><td v-for="s in ships"><img :src="'assets/icons/' + s.imgName"/></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.shellPower!=null">{{$t('shell_power')}}: {{s.shellPower}}</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.nbPower!=null">{{$t('nb_power')}}: {{s.nbPower}}</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.aswPower!=null">{{$t('asw_power')}}: {{s.aswPower}}</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.canOASW">{{$t('can_oasw')}}</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.accBasic!=null"><span class="tooltip" :title="$t('standard_accuracy_tooltip')">{{$t('standard_accuracy')}}</span>: {{s.accBasic}}</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.accFit!=null">{{$t('fit_accuracy')}}: {{s.accFit}}</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.accFitNight!=null">{{$t('fit_accuracy_night')}}: {{s.accFitNight}}</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.evaBasic!=null"><span class="tooltip" :title="$t('standard_evasion_tooltip')">{{$t('standard_evasion')}}</span>: {{s.evaBasic}}</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.asTypes!=null">
				<div>{{$t('artillery_spot_rate')}}:</div>
				<div class="sub">{{$t('in_ASP_AS')}}</div>
				<div v-for="type in s.asTypes" class="sub">{{$t('spotting.' + type.name)}}: {{type.rateASP}}% / {{type.rateAS}}%</div>
			</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.nbTypes!=null">
				<div>{{$t('night_attack')}}:</div>
				<div v-for="type in s.nbTypes" class="sub">{{$t('nbatk.' + type.name)}}: {{type.rate}}%</div>
			</div></td></tr>
			<tr><td v-for="s in ships"><div>
				<div>{{$t('anti_air')}}:</div>
				<div class="sub" v-show="s.aaProp!=null">{{$t('proportional')}}: {{s.aaProp}}%</div>
				<div class="sub" v-show="s.aaFlat!=null">{{$t('flat')}}: {{s.aaFlat}}</div>
				<div v-for="type in s.aaciTypes">
					<div>{{$t('aaci')}} {{type.id ? $t('aaci_type',[type.id]) : $t('aaci_none')}}:</div>
					<div class="sub" v-show="type.id">{{$t('aaci_planes')}}: {{type.num}}</div>
					<div class="sub">{{$t('aaci_rate')}}: {{type.rate}}%</div>
					<div class="sub" v-show="type.rateFleet!=null"><div class="sub">(<span class="tooltip" :title="$t('aaci_rate_fleet_tooltip')">{{$t('aaci_rate_fleet')}}</span>: {{type.rateFleet}}%)</div></div>
					<div class="sub" v-show="type.id">{{$t('aaci_multiplier')}}: {{type.mod}}</div>
				</div>
				<div v-show="s.rocketBarrage!=null">{{$t('rocket_barrage')}}: {{s.rocketBarrage}}%</div>
			</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.profAcc||s.profAir">
				<div>{{$t('plane_proficiency')}}:</div>
				<div class="sub" v-show="s.profAcc!=null">{{$t('prof_acc_bonus')}}: {{s.profAcc}}</div>
				<div class="sub" v-show="s.profCritRate!=null">{{$t('prof_crit_rate_bonus')}}: {{s.profCritRate}}%</div>
				<div class="sub" v-show="s.profCritMult!=null">{{$t('prof_crit_multiplier')}}: {{s.profCritMult}}</div>
				<div class="sub" v-show="s.profAir!=null">{{$t('prof_air_power')}}: {{s.profAir}}</div>
			</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.nightContactRates.some(v => v)">
				<div>{{$t('night_contact')}}:</div>
				<div class="sub" v-show="s.nightContactRates[2]">3+<img style="vertical-align:middle" src="assets/stats/acc.png"/>: {{s.nightContactRates[2]}}%</div>
				<div class="sub" v-show="s.nightContactRates[1]">2<img style="vertical-align:middle" src="assets/stats/acc.png"/>: {{s.nightContactRates[1]}}%</div>
				<div class="sub" v-show="s.nightContactRates[0]">1<img style="vertical-align:middle" src="assets/stats/acc.png"/>: {{s.nightContactRates[0]}}%</div>
			</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.hasImprove">
				<div>{{$t('sas_improvement')}}:</div>
				<div class="sub" v-show="s.imprShellPow!=null">{{$t('impr_shelling_power')}}: {{s.imprShellPow}}</div>
				<div class="sub" v-show="s.imprShellAcc!=null">{{$t('impr_shelling_acc')}}: {{s.imprShellAcc}}</div>
				<div class="sub" v-show="s.imprShellEva!=null">{{$t('impr_shelling_evade')}}: {{s.imprShellEva}}</div>
				<div class="sub" v-show="s.imprNightPow!=null">{{$t('impr_night_power')}}: {{s.imprNightPow}}</div>
				<div class="sub" v-show="s.imprNightAcc!=null">{{$t('impr_night_acc')}}: {{s.imprNightAcc}}</div>
				<div class="sub" v-show="s.imprTorpedoPow!=null">{{$t('impr_torpedo_power')}}: {{s.imprTorpedoPow}}</div>
				<div class="sub" v-show="s.imprTorpedoAcc!=null">{{$t('impr_torpedo_acc')}}: {{s.imprTorpedoAcc}}</div>
				<div class="sub" v-show="s.imprTorpedoEva!=null">{{$t('impr_torpedo_evade')}}: {{s.imprTorpedoEva}}</div>
				<div class="sub" v-show="s.imprASWPow!=null">{{$t('impr_asw_power')}}: {{s.imprASWPow}}</div>
				<div class="sub" v-show="s.imprASWAcc!=null">{{$t('impr_asw_acc')}}: {{s.imprASWAcc}}</div>
				<div class="sub" v-show="s.imprAR!=null">{{$t('impr_armour')}}: {{s.imprAR}}</div>
			</div></td></tr>
			<tr><td v-for="s in ships"><div v-show="s.hasInstall">
				<div>{{$t('vs_installation_power')}}:</div>
				<div class="sub" v-show="s.vsSoftSkin!=null">{{$t('soft_skin')}}: {{s.vsSoftSkin}}</div>
				<div class="sub" v-show="s.vsPillbox!=null">{{$t('pillbox')}}: {{s.vsPillbox}}</div>
				<div class="sub" v-show="s.vsIso!=null">{{$t('iso_hime')}}: {{s.vsIso}}</div>
				<div class="sub" v-show="s.vsHarbourSummer!=null">{{$t('harbour_summer')}}: {{s.vsHarbourSummer}}</div>
				<div class="sub" v-show="s.modSupply!=null">{{$t('supply_post_mod')}}: {{s.modSupply}}</div>
				<div class="sub" v-show="s.modAnchorage!=null">{{$t('anchorage_post_mod')}}: {{s.modAnchorage}}</div>
				<div class="sub" v-show="s.modDock!=null">{{$t('dock_post_mod')}}: {{s.modDock}}</div>
			</div></td></tr>
			</table>
		</div>
		</vmodal>
	</div></div>
	
	<div id="divAdditionalStatsLBAS"><div v-show="active">
		<vmodal :active="active" @vclose="doClose">
		<div id="divAdditionalStatsLBASMain" class="additionalStatsMain">
			<table>
			<tr><td v-for="b in bases"><img :src="'assets/icons/' + b.imgName"/></td></tr>
			<tr><td v-for="b in bases"><div v-show="b.airPowerSortie!=null">{{$t('sortie_air_power')}}: {{b.airPowerSortie}}</div></td></tr>
			<tr><td v-for="b in bases">
				<div v-show="b.airPowerDefend!=null">{{$t('defence_air_power')}}: {{b.airPowerDefend}}</div>
				<div class="sub" v-show="b.airPowerDefendHA!=null">{{$t('high_altitude')}}: {{b.airPowerDefendHA}}</div>
			</td></tr>
			<tr><td v-for="b in bases"><div v-show="b.range!=null">{{$t('lbas_range')}}: {{b.range}}<span v-show="b.rangePlus"> +{{b.rangePlus}}</span></div></td></tr>
			<tr><td v-for="b in bases">
				<div v-show="b.costFuel!=null||b.costAmmo!=null">{{$t('lbas_sortie_cost')}}:</div>
				<div class="sub" v-show="b.costFuel!=null">{{$t('lbas_fuel')}}: {{b.costFuel}}</div>
				<div class="sub" v-show="b.costFuel!=null">{{$t('lbas_ammo')}}: {{b.costAmmo}}</div>
			</td></tr>
			</table>
		</div>
		</vmodal>
	</div></div>
	
	<div id="divDeckbuilderImporter"><div v-show="active">
		<vmodal :active="active" @vclose="active=false">
		<div id="divDeckbuilderImporterMain">
			<div>
				<i18n-t keypath="import_export_data_format" scope="global">
					<template v-slot:link_db><a href="http://kancolle-calc.net/deckbuilder.html" target="_blank">{{$t('deckbuilder')}}</a></template>
					<template v-slot:link_aircalc><a href="https://noro6.github.io/kc-web/#/" target="_blank">{{$t('aerial_combat_simulator')}}</a></template>
				</i18n-t>
				<br>
				{{$t('note_db_from_text')}}
			</div>
			<div class="sectionWrap">
				<div class="sectionLeft">
					<div><textarea ref="textImport" cols="30" rows="2" autocomplete="off" v-model="textImport" @click="onclickSelectAll"></textarea></div>
					<div>
						<div><input type="button" value="Import" @click="onclickImport"/></div>
						<div class="sectionWrap">
							<div>
								<div><label><input type="checkbox" v-model="importMain"/>{{$t('main_fleet')}}: </label><select v-model.number="fleetNumMain"><option value="11">1+2 {{$t('CTF')}}</option><option value="12">1+2 {{$t('STF')}}</option><option value="13">1+2 {{$t('TCF')}}</option><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
								<div><label><input type="checkbox" v-model="importLBAS"/>{{$t('lbas')}}</label></div>
							</div>
							<div>
								<div><label><input type="checkbox" v-model="importSupportN"/>{{$t('import_support_normal')}}: </label><select v-model.number="fleetNumSupportN"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
								<div><label><input type="checkbox" v-model="importSupportB"/>{{$t('import_support_boss')}}: </label><select v-model.number="fleetNumSupportB"><option>1</option><option>2</option><option>3</option><option>4</option></select></div>
							</div>
						</div>
					</div>
				</div>
				<div>
					<div><textarea ref="textExport" cols="30" rows="2" autocomplete="off" v-model="textExport" @click="onclickSelectAll"></textarea></div>
					<!-- <div><input type="button" :value="$t('export_text')" @click="onclickExport"/></div> -->
					<div><input type="button" :value="$t('open_in_aircalc')" @click="onclickOpenLBASSim"/>&nbsp;<input type="button" :value="$t('open_in_jervis')" @click="onclickOpenJervis"/></div>
					<div><input type="button" :value="$t('open_in_compass_sim')" @click="onclickOpenCompassSim"/>&nbsp;<input type="button" :value="$t('open_in_deckbuilder')" @click="onclickOpenDb"/></div>
				</div>
			</div>
		</div>
		</vmodal>
	</div></div>
	
	<div id="divKCNavCompImporter"><div v-show="active">
		<vmodal :active="active" @vclose="canClose&&(active=false)">
		<div id="divKCNavCompImporterMain" class="kcnavImporter">
			<div id="divKCNavCompImporterSettingsWrap" class="kcnavImporterSettingsWrap">
				<div>
					<table>
					<tr>
						<td><label for="inputNavImportWorld">{{$t('world')}}:</label></td>
						<td><input id="inputNavImportWorld" required ref="inputWorld" type="number" min="1" max="99" v-model="world" @change="onchangeWorldMap"/></td>
						<td><select class="suggestion" v-model="selectWorld" @change="onchangeSelectWorld"><option value="0"></option><option v-for="option in optionsWorld" :value="option.id">{{$t('area.' + option.name)}}</option></select></td>
					</tr>
					<tr>
						<td><label for="inputNavImportMapnum">{{$t('map')}}:</label></td>
						<td><input id="inputNavImportMapnum" required ref="inputMapnum" type="number" min="1" max="9" v-model="mapnum" @change="onchangeWorldMap"/></td>
					</tr>
					<tr>
						<td><label for="inputNavImportEdges" :title="$t('edges_desc')">{{$t('edges')}}:</label></td>
						<td><input id="inputNavImportEdges" required ref="inputEdges" type="text" v-model="edges"/></td>
						<td><select class="suggestion" v-model="selectLetter" @change="onchangeSelectLetter"><option value="0"></option><option v-for="option in optionsLetter" :value="option.edges">{{option.letter}}</option></select></td>
					</tr>
					</table>
				</div>
				<div>
					<table v-show="!isFriendFleet">
					<tr>
						<td><label for="inputNavImportGaugeNum">{{$t('gauge')}}:</label></td>
						<td><input id="inputNavImportGaugeNum" type="number" min="1" max="4" v-model="gaugeNum"/></td>
					</tr>
					<tr>
						<td><label>{{$t('map_hp')}}:</label></td>
						<td><input type="number" min="0" max="99999" v-model="gaugeHPMin"/>~<input type="number" min="0" max="99999" v-model="gaugeHPMax"/></td>
					</tr>
					<tr>
						<td><label for="selNavImportDiff">{{$t('difficulty')}}:</label>
						<td><select id="selNavImportDiff" v-model="diff">
							<option value="0">{{$t('diff_all')}}</option>
							<option value="4">{{$t('diff_A')}}</option>
							<option value="3">{{$t('diff_B')}}</option>
							<option value="2">{{$t('diff_C')}}</option>
							<option value="1">{{$t('diff_D')}}</option>
						</select></td>
					</tr>
					<tr>
						<td><label>{{$t('hq_level')}}:</label></td>
						<td><input type="number" min="1" max="120" v-model="hqMin"/>~<input type="number" min="1" max="120" v-model="hqMax"/></td>
					</tr>
					</table>
					<div v-show="isFriendFleet"><label><input type="checkbox" v-model="ffStrong"/><img src="assets/stats/ibuild.png"/>?</label></div>
					<div v-show="isFriendFleet"><label><input type="checkbox" v-model="ffSkipSame"/>{{$t('ff_skip_comps')}}</label></div>
					<div><label>{{$t('date')}}: <input type="date" v-model="dateStart"/></label>~<input type="date" v-model="dateEnd"/></div>
				</div>
			</div>
			<input type="button" :value="$t('submit')" :disabled="!canClose" @click="onclickLoad" />
			<span v-show="txtLoading">{{txtLoading}}</span>
			<span class="note" v-show="showNoData">{{$t('no_comps_found')}}</span>
			<span class="note" v-show="showError">{{$t('kcnav_error')}}</span>
			<span class="note" v-show="showTimeout">{{$t('kcnav_timed_out')}}</span>
		</div>
		</vmodal>
	</div></div>
	
	<div id="divBonusImporter"><div v-show="active">
		<vmodal :active="active" @vclose="canClose&&(active=false)">
		<div id="divBonusImporterMain">
			<div class="kcnavImporter" v-show="bonusData.length<=0">
				<div class="header"><i18n-t keypath="import_bonuses_dewy" scope="global"><template v-slot:link_dewy><a href="https://github.com/sorewachigauyo/kc-event-bonus" target="_blank">{{$t('dewy')}}</a></template></i18n-t>:</div>
				<div class="kcnavImporterSettingsWrap">
					<div>
						<table>
						<tr>
							<td><label for="inputNavImportWorldB">{{$t('world')}}:</label></td>
							<td><input id="inputNavImportWorldB" required ref="inputWorld" type="number" min="1" max="99" v-model="world" @change="onchangeWorldMap"/></td>
							<td><select class="suggestion" v-model="selectWorld" @change="onchangeSelectWorld"><option value="0"></option><option v-for="option in optionsWorld" :value="option.id">{{$t('area.' + option.name)}}</option></select></td>
						</tr>
						<tr>
							<td><label for="inputNavImportMapnumB">{{$t('map')}}:</label></td>
							<td><input id="inputNavImportMapnumB" required ref="inputMapnum" type="number" min="1" max="9" v-model="mapnum" @change="onchangeWorldMap"/></td>
						</tr>
						<tr>
							<td><label for="inputNavImportNodeB">{{$t('node')}}:</label></td>
							<td><input id="inputNavImportNodeB" required ref="inputNode" type="text" v-model="letter"/></td>
							<td><select class="suggestion" v-model="selectLetter" @change="onchangeSelectLetter"><option value="0"></option><option v-for="option in optionsLetter" :value="option.letter">{{option.letter}}</option></select></td>
						</tr>
						</table>
					</div>
					<div>
						<div><label><input type="checkbox" v-model="fromDebuffed"/>{{$t('debuffed')}}</label></div>
						<div><label><input type="checkbox" v-model="fromFF"/>{{$t('from_friend_fleet')}}</label></div>
						<div><label><input type="checkbox" v-model="fromBoss"/>{{$t('from_targeting_boss')}}</label></div>
					</div>
					<div v-show="!forNode">
						<div><label><input type="checkbox" v-model="includeMain"/>{{$t('import_to_main_fleet')}}</label></div>
						<div><label><input type="checkbox" v-model="includeFF"/>{{$t('import_to_friend_fleets')}}</label></div>
					</div>
				</div>
				<input type="button" :value="$t('load_from_dewy')" :disabled="!canClose" @click="onclickLoad('dewy')" />
				<!-- <input type="button" :value="$t('load_from_kcnav')" :disabled="!canClose" @click="onclickLoad('kcnav')" /> -->
				<span v-show="txtLoading">{{txtLoading}}</span>
				<span class="note" v-show="showNoData">{{$t('no_data_found')}}</span>
				<span class="note" v-show="showNoMatches">{{$t('no_ship_matches_found')}}</span>
				<span class="note" v-show="showError">{{$t('request_error_not_found')}}</span>
				<span class="note" v-show="showTimeout">{{$t('request_timed_out')}}</span>
			</div>
			<div v-show="bonusData.length">
				<table class="bonusTable">
					<tr><th>{{$t('ship')}}</th><th>{{$t('count')}}</th><th>{{$t('max_low')}}</th><th>{{$t('min_high')}}</th><th>{{$t('import_value')}}</th></tr>
					<tr v-for="bonusShip in bonusData" :key="bonusShip.id">
						<td>{{bonusShip.name}}</td>
						<td>{{bonusShip.count}}</td>
						<td>{{bonusShip.min}}</td>
						<td>{{bonusShip.max}}</td>
						<td><input type="number" v-model.number="bonusShip.value" min="0" max="99" step="any"/></td>
					</tr>
				</table>
				<div>
					<input type="button" :value="$t('low_all')" @click="onclickSetAll('min')"/>
					<input type="button" :value="$t('high_all')" @click="onclickSetAll('max')"/>
					<input type="button" :value="$t('average_all')" @click="onclickSetAll('avg')"/>
					&nbsp;&nbsp;&nbsp;
					<input type="button" :value="$t('confirm')" @click="onclickConfirm"/>
				</div>
			</div>
		</div>
		</vmodal>
	</div></div>
	
	<div id="divSimBackup"><div v-show="active">
		<vmodal :active="active" @vclose="canClose&&(active=false)">
		<div id="divSimBackupMain">
			<div v-show="isReplayImport">{{$t('warn_replay_import')}}<br>{{$t('download_backup_of_current')}}</div>
			<div v-show="!isReplayImport"><span class="header">{{$t('download_a_backup')}}</span></div>
			<div class="sectionWrap">
				<div>
					<div><input type="button" :value="$t('download')" @click="onclickDownload"/></div>
				</div>
				<div v-show="!isReplayImport">
					<hr>
					<input type="button" :value="$t('create_shared_link')" :disabled="shareURLLoading" @click="onclickShareURL"/>
					<span v-show="$i18n.locale=='ja'">&nbsp;<a href="https://twitter.com/momemi_kc/status/1811049862663684576" target="_blank">(!)</a></span>
					<span v-show="$i18n.locale!='ja'" style="color:darkorange">&nbsp;<span class="tooltip" :title="$t('create_shared_link_note')">(!)</span>
					<span style="color:green" v-show="showShareURLCopied">&nbsp;{{$t('copied_to_clipboard')}}</span>
					<span class="error" v-show="showShareURLError">&nbsp;{{$t('error')}}</span>
				</div>
				<div v-show="!isReplayImport">
					<hr>
					<div><span class="header">{{$t('load_backup')}}:</span> <input type="file" accept=".kcsim" @change="onchangeFileBackup"/> <span class="error" v-show="showImportError">{{$t('error')}}</span></div>
					<div>
						<input type="button" :value="$t('import_all')" @click="onclickImportAll"/>&nbsp;
						<input type="button" :value="$t('import_player_only')" @click="onclickImportPlayer"/>
					</div>
				</div>
				<div v-show="!isReplayImport">
					<hr>
					<input type="button" :value="$t('reset_all_data')" @click="onclickResetAll"/><label><input type="checkbox" v-model="confirmReset">{{$t('reset_confirm')}}</label>
				</div>
			</div>
			<div class="footer" v-show="isReplayImport">
				<input type="button" :value="$t('continue')" @click="onclickContinue"/>
			</div>
		</div>
		</vmodal>
	</div></div>
	
	<div id="divFCFSettings"><div v-show="active">
		<vmodal :active="active" @vclose="canClose&&(active=false)">
		<div id="divFCFSettingsMain" v-if="settings">
			<div>
				<label><span class="header">{{$t('require_los_after_fcf')}}:</span> <input type="number" step="any" v-model.number="settings.los" :class="{'changed':settings.los!=null&&settings.los!==''}"/></label>
				<select v-model="settings.losC"><option v-for="n in 4" :value="n">C{{n}}</option></select>
				&nbsp;<i18n-t keypath="require_on_node" scope="global">
					<template v-slot:sel_node><select v-model="settings.losNode"><option value="0">{{$t('node_all')}}</option><option v-for="(id,i) in nodes" :value="id">{{i+1}}</option></select></template>
				</i18n-t>
			</div>
			<div>
				<label><span class="header">{{$t('require_radar_after_fcf')}}:</span> <input type="number" min="0" max="12" v-model.number="settings.radarCount" :class="{'changed':settings.radarCount}"/></label>
				&nbsp;<i18n-t keypath="require_on_node" scope="global">
					<template v-slot:sel_node><select v-model="settings.radarNode"><option value="0">{{$t('node_all')}}</option><option v-for="(id,i) in nodes" :value="id">{{i+1}}</option></select></template>
				</i18n-t>
			</div>
			<div>
				<div><span class="header">{{$t('require_ship_counts')}}:</span></div>
				<div v-for="rule in settings.rules">
					{{rule.shipStr}} &ge; {{rule.count}}
					&nbsp;<i18n-t keypath="require_ships_on_node" scope="global">
						<template v-slot:sel_node><select v-model="rule.node"><option value="0">{{$t('node_all')}}</option><option v-for="(id,i) in nodes" :value="id">{{i+1}}</option></select></template>
					</i18n-t>
					&nbsp;<input type="button" value="&#10006;" @click="onclickDelRule(rule)"/>
				</div>
				<div>
					<input v-model="ruleNew.shipStr" :placeholder="$t('ship_counts_desc')" ref="inputShipStrNew"/>
					&ge; <input type="number" min="0" max="12" v-model="ruleNew.count" ref="inputCountNew"/>
					&nbsp;<i18n-t keypath="require_ships_on_node" scope="global">
						<template v-slot:sel_node><select v-model="ruleNew.node"><option value="0">{{$t('node_all')}}</option><option v-for="(id,i) in nodes" :value="id">{{i+1}}</option></select></template>
					</i18n-t>
					&nbsp;<input type="button" :value="$t('add')" @click="onclickAddRule"/>
				</div>
			</div>
			<div>
				<span class="header">{{$t('never_use_on')}}:</span>
				<div v-for="ships in shipGroups" class="shipGroup">
					<div v-for="ship in ships" style="position:relative">
						<img :src="'assets/icons/' + ship.imgName" :style="{'opacity':ship.neverFCF?1:.35}" @click="onclickShipCanRetreat(ship)"/>
						<span class="shipType">{{ship.type}}</span>
					</div>
				</div>
			</div>
			<div>
				<span class="note">{{$t('note_require_on_node')}}</span>
			</div>
		</div>
		</vmodal>
	</div></div>
	
	<div id="divAutoBonus"><div v-show="active">
		<vmodal :active="active" @vclose="canClose&&(active=false)">
		<div class="autoBonusMain" v-show="!isPreloader">
			<div><span class="header">{{$t('auto_set_historical_bonus')}}</span></div>
			<div v-show="isUpdate">
				<i18n-t keypath="current_data_set_updated" scope="global">
					<template v-slot:date><span v-show="datePreloader"> ({{datePreloader}})</span></template>
				</i18n-t>
			</div>
			<div v-show="!isUpdate">
				<label><input value="preset" type="radio" v-model="type"/> <span class="tooltip" :title="$t('manually_compiled_bonuses')">{{$t('simulator_preset')}}</span></label>&nbsp;&nbsp;&nbsp;
				<label><input value="dewy" type="radio" v-model="type" @change="onclickDewy"/> <span class="tooltip" :title="$t('bonus_ranges_auto_calc')">{{$t('dewy')}}</span></label> (<a href="https://github.com/sorewachigauyo/kc-event-bonus" target="_blank">kc-event-bonus</a>)
			</div>
			<div v-show="type=='preset'">
				<div>
					<label>{{$t('set')}}: <select v-model="keyPreset" :disabled="isUpdate" @change="onchangeNamePreset"><option value="">{{$t('none')}}</option><option v-for="opt in optionsPresetName" :value="opt.key">{{$t('bonus.' + opt.name)}}</option></select></label>
					<span class="note" v-show="datePreset"> ({{datePreset}})</span>
				</div>
				<div v-show="notePreset">
					<span class="note" v-show="notePreset">{{$t('note')}}: {{notePreset}}</span>
				</div>
			</div>
			<div v-show="type=='dewy'">
				<label>{{$t('set')}}: <select v-model="keyDewy" :disabled="!optionsDewyName.length || isUpdate" @change="onchangeNameDewy"><option value="">{{$t('none')}}</option><option v-for="opt in optionsDewyName" :value="opt.key">{{$t('bonus.' + opt.name)}}</option></select></label>
			</div>
			<div v-show="type=='preset' && !isUpdate">
				<div v-for="(node,i) in nodeToLetterListPreset">
					<label>{{$t('node_n',[i+1])}}: <select v-model="node.letter"><option value=""></option><option v-for="letter in optionsPresetLetter">{{letter}}</option></select></label>
				</div>
			</div>
			<div v-show="type=='dewy' && !isUpdate">
				<div v-for="(node,i) in nodeToLetterListDewy">
					<label>{{$t('node_n',[i+1])}}: <select v-model="node.letter" @change="onchangeLetterDewy(node.letter)"><option value="">{{$t('none')}}</option><option v-for="letter in optionsDewyLetter">{{letter}}</option></select></label>
				</div>
			</div>
			<div v-show="type=='preset'">
				{{$t('damage')}}: {{$t('use_preset_values')}}
			</div>
			<div v-show="type=='dewy'">
				<label>{{$t('damage')}}: <select v-model="dmgType">
					<option value="0">{{$t('use_average')}}</option>
					<option value="1">{{$t('use_min')}}</option>
					<option value="2">{{$t('use_max')}}</option>
				</select></label>
			</div>
			<div>
				<label>{{$t('accuracy_evasion')}}: <select v-model="accEvaType">
					<option value="4">{{$t('none_ignore')}}</option>
					<option value="0">{{$t('none_overwrite')}}</option>
					<option value="1" v-if="type=='preset'" :disabled="!hasAccEva">{{$t('use_estimated_values')}}</option>
					<option value="2">{{$t('use_equal_damage_mod')}}</option>
					<option value="3">{{$t('use_half_damage_mod')}}</option>
				</select></label>
			</div>
			<div v-show="type=='preset' && hasDebuff">
				<label><input type="checkbox" v-model="useDebuff"/> {{$t('debuffed')}}</label>
			</div>
			<div v-show="type=='preset' && hasSpeculated">
				<label><input type="checkbox" v-model="useSpeculated"/> <span class="tooltip" :title="$t('include_speculated_ships_desc')"> {{$t('include_speculated_ships')}}</span></label>
			</div>
			<div class="autoBonusMainFoot">
				<div><input type="button" :value="$t('start')" :disabled="!canStart" @click="onclickStart"/></div>
				<div v-show="isUpdate"><input type="button" :value="$t('dismiss')" @click="onclickDismiss"/></div>
				<div style="width:50px">
					<div v-show="!hasError"><vloading ref="txtLoading"></vloading></div>
					<div v-show="hasError" class="error">$t('error')</div>
				</div>
				<div>
					<div><label><input type="checkbox" v-model="applyToCurrent" :disabled="isUpdate"/> <span class="tooltip" :title="$t('apply_to_current_desc')">{{$t('apply_to_current')}}</span></label></div>
					<!-- <div :class="classApplyToCurrentDmgOnly"><label><input type="checkbox" v-model="applyToCurrentDmgOnly"/>{{$t('apply_dmg_only')}}</label></div> -->
				</div>
			</div>
		</div>
		<div class="autoBonusMain" v-show="isPreloader">
			<div><span class="header">{{$t('auto_set_historical_bonus')}}</span></div>
			<div v-show="!hasError">{{$t('loading')}} <vloading ref="txtLoadingPL"></vloading></div>
			<div v-show="!hasError"><input type="button" :value="$t('cancel')" @click="cancelPreload"/></div>
			<div v-show="hasError" class="error">{{$t('load_error_autobonus_turn_off')}}</div>
		</div>
		</vmodal>
	</div></div>
	
	<div id="divPlaneBonus"><div v-show="active">
		<vmodal :active="active" @vclose="canClose&&doClose()">
		<div id="divPlaneBonusMain" v-if="ship">
			<div id="divPlaneBonusNotes">
				<div v-show="!isLBAS">{{$t('plane_bonus_note_1_ship')}}</div>
				<div v-show="isLBAS">{{$t('plane_bonus_note_1_lbas')}}</div>
				<div v-show="!isLBAS">{{$t('plane_bonus_note_2_ship')}}</div>
				<div v-show="isLBAS">{{$t('plane_bonus_note_2_lbas')}}</div>
			</div>
			<table>
			<tr>
				<th colspan="2"><div style="width:125px"></div></th>
				<th v-for="n in groups.length" v-if="!isLBAS">{{$t('group_n_ship',[n])}}</th>
				<th v-for="n in groups.length" v-if="isLBAS">{{$t('group_n_lbas',[n])}}</th>
			</tr>
			<tr>
				<th colspan="2" class="bonusHeader">{{$t('bonus_dmg')}}:</th>
				<td v-for="group in groups"><input type="number" v-model.number="group.bonusDmg" min="0" max="99" step=".01"/></td>
			</tr>
			<tr>
				<th colspan="2" class="bonusHeader">{{$t('bonus_acc')}}:</th>
				<td v-for="group in groups"><input type="number" v-model.number="group.bonusAcc" min="0" max="99" step=".01"/></td>
			</tr>
			<tr v-show="!isLBAS">
				<th colspan="2" class="bonusHeader">{{$t('bonus_eva')}}:</th>
				<td v-for="group in groups"><input type="number" v-model.number="group.bonusEva" min="0" max="99" step=".01"/></td>
			</tr>
			<tr v-show="!isLBAS">
				<th colspan="2" class="bonusHeader"><span class="tooltip" :title="$t('air_attacks_only_tooltip')">{{$t('air_attacks_only')}}</span>:</th>
				<td v-for="group in groups"><input type="checkbox" v-model="group.airOnly"/></td>
			</tr>
			<tr style="height:10px"></tr>
			<tr v-for="n in equips.length">
				<th><div class="equipHeader">
					<img class="equipIcon" src="assets/items/0.png" />
					<img class="equipIcon top" :src="'assets/items/' + equips[n-1].imgName + '.png'"/>
				</div></th>
				<th class="equipName">{{$t('equip_name_'+(equips[n-1].name||'0'))}}</th>
				<td v-for="group in groups"><input type="checkbox" v-model="group.equipIdx[n-1]"/></td>
			</tr>
			</table>
			<div id="divPlaneBonusTotals">
				<div><table>
				<tr><th></th><th><span v-show="!isLBAS">{{$t('max_plane_bonus_ship')}}</span><span v-show="isLBAS">{{$t('max_plane_bonus_lbas')}}</span></th><th v-show="!isLBAS">{{$t('max_total_bonus')}}</th></tr>
				<tr><th>{{$t('dmg')}}:</th><td>{{getBonusTotal('bonusDmg')}}</td><td v-show="!isLBAS">{{getBonusTotalShip('bonusDmg')}}</td></tr>
				<tr><th>{{$t('acc')}}:</th><td>{{getBonusTotal('bonusAcc')}}</td><td v-show="!isLBAS">{{getBonusTotalShip('bonusAcc')}}</td></tr>
				<tr v-show="!isLBAS"><th>{{$t('eva')}}:</th><td>{{getBonusTotal('bonusEva')}}</td><td>{{getBonusTotalShip('bonusEva')}}</td></tr>
				</table></div>
				<div><table v-if="isLBAS && hasBonusOnEquip">
				<tr><th :colspan="this.ship.equips.length">{{$t('max_total_bonus')}}</th></tr>
				<tr><th v-for="equip in this.ship.equips" class="equipName" v-show="equip.mstId">{{$t('equip_name_'+(equip.name||'0'))}}</th></tr>
				<tr><td v-for="equip in this.ship.equips" v-show="equip.mstId">{{getBonusTotalEquip('bonusDmg',equip)}}</td></tr>
				<tr><td v-for="equip in this.ship.equips" v-show="equip.mstId">{{getBonusTotalEquip('bonusAcc',equip)}}</td></tr>
				</table></div>
			</div>
		</div>
		</vmodal>
	</div></div>
	
	
	<template id="tmpModal">
		<div class="overlayDark" tabindex="1" @focus.prevent="focusContentTop" @click="$emit('vclose')"></div>
		<div class="modalContent" tabindex="-1" ref="content" @keydown="onkeypressClose">
			<div tabindex="0" @focus.prevent="focusContentBottom"></div>
			<div tabindex="-1" ref="contentTop"></div>
			<slot></slot>
			<div tabindex="-1" ref="contentBottom"></div>
			<div tabindex="0" @focus.prevent="focusContentTop"></div>
		</div>
	</template>
	
	<template id="tmpLoading">
		<span v-show="txtLoading">{{txtLoading}}</span>
	</template>
	
	
	<script src="js/simulator-ui/cmp.js"></script>
	<script src="js/simulator-ui/bonus.js"></script>
	<script src="js/simulator-ui/fleet-editor.js"></script>
	<script src="js/simulator-ui/selector.js"></script>
	<script src="js/simulator-ui/convert.js"></script>
	<script src="js/simulator-ui/sim-interface.js"></script>
	<script src="js/simulator-ui/ui-main.js"></script>
</body>
</html>